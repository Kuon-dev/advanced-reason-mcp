#!/usr/bin/env node
// @bun
var F;(function(X){X.assertEqual=(G)=>G;function Q(G){}X.assertIs=Q;function W(G){throw new Error}X.assertNever=W,X.arrayToEnum=(G)=>{let Y={};for(let H of G)Y[H]=H;return Y},X.getValidEnumValues=(G)=>{let Y=X.objectKeys(G).filter((B)=>typeof G[G[B]]!=="number"),H={};for(let B of Y)H[B]=G[B];return X.objectValues(H)},X.objectValues=(G)=>{return X.objectKeys(G).map(function(Y){return G[Y]})},X.objectKeys=typeof Object.keys==="function"?(G)=>Object.keys(G):(G)=>{let Y=[];for(let H in G)if(Object.prototype.hasOwnProperty.call(G,H))Y.push(H);return Y},X.find=(G,Y)=>{for(let H of G)if(Y(H))return H;return},X.isInteger=typeof Number.isInteger==="function"?(G)=>Number.isInteger(G):(G)=>typeof G==="number"&&isFinite(G)&&Math.floor(G)===G;function J(G,Y=" | "){return G.map((H)=>typeof H==="string"?`'${H}'`:H).join(Y)}X.joinValues=J,X.jsonStringifyReplacer=(G,Y)=>{if(typeof Y==="bigint")return Y.toString();return Y}})(F||(F={}));var a0;(function(X){X.mergeShapes=(Q,W)=>{return{...Q,...W}}})(a0||(a0={}));var L=F.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),u=(X)=>{switch(typeof X){case"undefined":return L.undefined;case"string":return L.string;case"number":return isNaN(X)?L.nan:L.number;case"boolean":return L.boolean;case"function":return L.function;case"bigint":return L.bigint;case"symbol":return L.symbol;case"object":if(Array.isArray(X))return L.array;if(X===null)return L.null;if(X.then&&typeof X.then==="function"&&X.catch&&typeof X.catch==="function")return L.promise;if(typeof Map!=="undefined"&&X instanceof Map)return L.map;if(typeof Set!=="undefined"&&X instanceof Set)return L.set;if(typeof Date!=="undefined"&&X instanceof Date)return L.date;return L.object;default:return L.unknown}},M=F.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),V4=(X)=>{return JSON.stringify(X,null,2).replace(/"([^"]+)":/g,"$1:")};class v extends Error{get errors(){return this.issues}constructor(X){super();this.issues=[],this.addIssue=(W)=>{this.issues=[...this.issues,W]},this.addIssues=(W=[])=>{this.issues=[...this.issues,...W]};let Q=new.target.prototype;if(Object.setPrototypeOf)Object.setPrototypeOf(this,Q);else this.__proto__=Q;this.name="ZodError",this.issues=X}format(X){let Q=X||function(G){return G.message},W={_errors:[]},J=(G)=>{for(let Y of G.issues)if(Y.code==="invalid_union")Y.unionErrors.map(J);else if(Y.code==="invalid_return_type")J(Y.returnTypeError);else if(Y.code==="invalid_arguments")J(Y.argumentsError);else if(Y.path.length===0)W._errors.push(Q(Y));else{let H=W,B=0;while(B<Y.path.length){let z=Y.path[B];if(B!==Y.path.length-1)H[z]=H[z]||{_errors:[]};else H[z]=H[z]||{_errors:[]},H[z]._errors.push(Q(Y));H=H[z],B++}}};return J(this),W}static assert(X){if(!(X instanceof v))throw new Error(`Not a ZodError: ${X}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,F.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(X=(Q)=>Q.message){let Q={},W=[];for(let J of this.issues)if(J.path.length>0)Q[J.path[0]]=Q[J.path[0]]||[],Q[J.path[0]].push(X(J));else W.push(X(J));return{formErrors:W,fieldErrors:Q}}get formErrors(){return this.flatten()}}v.create=(X)=>{return new v(X)};var B0=(X,Q)=>{let W;switch(X.code){case M.invalid_type:if(X.received===L.undefined)W="Required";else W=`Expected ${X.expected}, received ${X.received}`;break;case M.invalid_literal:W=`Invalid literal value, expected ${JSON.stringify(X.expected,F.jsonStringifyReplacer)}`;break;case M.unrecognized_keys:W=`Unrecognized key(s) in object: ${F.joinValues(X.keys,", ")}`;break;case M.invalid_union:W="Invalid input";break;case M.invalid_union_discriminator:W=`Invalid discriminator value. Expected ${F.joinValues(X.options)}`;break;case M.invalid_enum_value:W=`Invalid enum value. Expected ${F.joinValues(X.options)}, received '${X.received}'`;break;case M.invalid_arguments:W="Invalid function arguments";break;case M.invalid_return_type:W="Invalid function return type";break;case M.invalid_date:W="Invalid date";break;case M.invalid_string:if(typeof X.validation==="object")if("includes"in X.validation){if(W=`Invalid input: must include "${X.validation.includes}"`,typeof X.validation.position==="number")W=`${W} at one or more positions greater than or equal to ${X.validation.position}`}else if("startsWith"in X.validation)W=`Invalid input: must start with "${X.validation.startsWith}"`;else if("endsWith"in X.validation)W=`Invalid input: must end with "${X.validation.endsWith}"`;else F.assertNever(X.validation);else if(X.validation!=="regex")W=`Invalid ${X.validation}`;else W="Invalid";break;case M.too_small:if(X.type==="array")W=`Array must contain ${X.exact?"exactly":X.inclusive?"at least":"more than"} ${X.minimum} element(s)`;else if(X.type==="string")W=`String must contain ${X.exact?"exactly":X.inclusive?"at least":"over"} ${X.minimum} character(s)`;else if(X.type==="number")W=`Number must be ${X.exact?"exactly equal to ":X.inclusive?"greater than or equal to ":"greater than "}${X.minimum}`;else if(X.type==="date")W=`Date must be ${X.exact?"exactly equal to ":X.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(X.minimum))}`;else W="Invalid input";break;case M.too_big:if(X.type==="array")W=`Array must contain ${X.exact?"exactly":X.inclusive?"at most":"less than"} ${X.maximum} element(s)`;else if(X.type==="string")W=`String must contain ${X.exact?"exactly":X.inclusive?"at most":"under"} ${X.maximum} character(s)`;else if(X.type==="number")W=`Number must be ${X.exact?"exactly":X.inclusive?"less than or equal to":"less than"} ${X.maximum}`;else if(X.type==="bigint")W=`BigInt must be ${X.exact?"exactly":X.inclusive?"less than or equal to":"less than"} ${X.maximum}`;else if(X.type==="date")W=`Date must be ${X.exact?"exactly":X.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(X.maximum))}`;else W="Invalid input";break;case M.custom:W="Invalid input";break;case M.invalid_intersection_types:W="Intersection results could not be merged";break;case M.not_multiple_of:W=`Number must be a multiple of ${X.multipleOf}`;break;case M.not_finite:W="Number must be finite";break;default:W=Q.defaultError,F.assertNever(X)}return{message:W}},_1=B0;function L4(X){_1=X}function T0(){return _1}var g0=(X)=>{let{data:Q,path:W,errorMaps:J,issueData:G}=X,Y=[...W,...G.path||[]],H={...G,path:Y};if(G.message!==void 0)return{...G,path:Y,message:G.message};let B="",z=J.filter((w)=>!!w).slice().reverse();for(let w of z)B=w(H,{data:Q,defaultError:B}).message;return{...G,path:Y,message:B}},U4=[];function V(X,Q){let W=T0(),J=g0({issueData:Q,data:X.data,path:X.path,errorMaps:[X.common.contextualErrorMap,X.schemaErrorMap,W,W===B0?void 0:B0].filter((G)=>!!G)});X.common.issues.push(J)}class S{constructor(){this.value="valid"}dirty(){if(this.value==="valid")this.value="dirty"}abort(){if(this.value!=="aborted")this.value="aborted"}static mergeArray(X,Q){let W=[];for(let J of Q){if(J.status==="aborted")return q;if(J.status==="dirty")X.dirty();W.push(J.value)}return{status:X.value,value:W}}static async mergeObjectAsync(X,Q){let W=[];for(let J of Q){let G=await J.key,Y=await J.value;W.push({key:G,value:Y})}return S.mergeObjectSync(X,W)}static mergeObjectSync(X,Q){let W={};for(let J of Q){let{key:G,value:Y}=J;if(G.status==="aborted")return q;if(Y.status==="aborted")return q;if(G.status==="dirty")X.dirty();if(Y.status==="dirty")X.dirty();if(G.value!=="__proto__"&&(typeof Y.value!=="undefined"||J.alwaysSet))W[G.value]=Y.value}return{status:X.value,value:W}}}var q=Object.freeze({status:"aborted"}),Y0=(X)=>({status:"dirty",value:X}),E=(X)=>({status:"valid",value:X}),s0=(X)=>X.status==="aborted",t0=(X)=>X.status==="dirty",s=(X)=>X.status==="valid",E0=(X)=>typeof Promise!=="undefined"&&X instanceof Promise;function x0(X,Q,W,J){if(W==="a"&&!J)throw new TypeError("Private accessor was defined without a getter");if(typeof Q==="function"?X!==Q||!J:!Q.has(X))throw new TypeError("Cannot read private member from an object whose class did not declare it");return W==="m"?J:W==="a"?J.call(X):J?J.value:Q.get(X)}function C1(X,Q,W,J,G){if(J==="m")throw new TypeError("Private method is not writable");if(J==="a"&&!G)throw new TypeError("Private accessor was defined without a setter");if(typeof Q==="function"?X!==Q||!G:!Q.has(X))throw new TypeError("Cannot write private member to an object whose class did not declare it");return J==="a"?G.call(X,W):G?G.value=W:Q.set(X,W),W}var U;(function(X){X.errToObj=(Q)=>typeof Q==="string"?{message:Q}:Q||{},X.toString=(Q)=>typeof Q==="string"?Q:Q===null||Q===void 0?void 0:Q.message})(U||(U={}));var N0,S0;class g{constructor(X,Q,W,J){this._cachedPath=[],this.parent=X,this.data=Q,this._path=W,this._key=J}get path(){if(!this._cachedPath.length)if(this._key instanceof Array)this._cachedPath.push(...this._path,...this._key);else this._cachedPath.push(...this._path,this._key);return this._cachedPath}}var N1=(X,Q)=>{if(s(Q))return{success:!0,data:Q.value};else{if(!X.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let W=new v(X.common.issues);return this._error=W,this._error}}}};function A(X){if(!X)return{};let{errorMap:Q,invalid_type_error:W,required_error:J,description:G}=X;if(Q&&(W||J))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);if(Q)return{errorMap:Q,description:G};return{errorMap:(H,B)=>{var z,w;let{message:j}=X;if(H.code==="invalid_enum_value")return{message:j!==null&&j!==void 0?j:B.defaultError};if(typeof B.data==="undefined")return{message:(z=j!==null&&j!==void 0?j:J)!==null&&z!==void 0?z:B.defaultError};if(H.code!=="invalid_type")return{message:B.defaultError};return{message:(w=j!==null&&j!==void 0?j:W)!==null&&w!==void 0?w:B.defaultError}},description:G}}class K{get description(){return this._def.description}_getType(X){return u(X.data)}_getOrReturnCtx(X,Q){return Q||{common:X.parent.common,data:X.data,parsedType:u(X.data),schemaErrorMap:this._def.errorMap,path:X.path,parent:X.parent}}_processInputParams(X){return{status:new S,ctx:{common:X.parent.common,data:X.data,parsedType:u(X.data),schemaErrorMap:this._def.errorMap,path:X.path,parent:X.parent}}}_parseSync(X){let Q=this._parse(X);if(E0(Q))throw new Error("Synchronous parse encountered promise.");return Q}_parseAsync(X){let Q=this._parse(X);return Promise.resolve(Q)}parse(X,Q){let W=this.safeParse(X,Q);if(W.success)return W.data;throw W.error}safeParse(X,Q){var W;let J={common:{issues:[],async:(W=Q===null||Q===void 0?void 0:Q.async)!==null&&W!==void 0?W:!1,contextualErrorMap:Q===null||Q===void 0?void 0:Q.errorMap},path:(Q===null||Q===void 0?void 0:Q.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:X,parsedType:u(X)},G=this._parseSync({data:X,path:J.path,parent:J});return N1(J,G)}"~validate"(X){var Q,W;let J={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:X,parsedType:u(X)};if(!this["~standard"].async)try{let G=this._parseSync({data:X,path:[],parent:J});return s(G)?{value:G.value}:{issues:J.common.issues}}catch(G){if((W=(Q=G===null||G===void 0?void 0:G.message)===null||Q===void 0?void 0:Q.toLowerCase())===null||W===void 0?void 0:W.includes("encountered"))this["~standard"].async=!0;J.common={issues:[],async:!0}}return this._parseAsync({data:X,path:[],parent:J}).then((G)=>s(G)?{value:G.value}:{issues:J.common.issues})}async parseAsync(X,Q){let W=await this.safeParseAsync(X,Q);if(W.success)return W.data;throw W.error}async safeParseAsync(X,Q){let W={common:{issues:[],contextualErrorMap:Q===null||Q===void 0?void 0:Q.errorMap,async:!0},path:(Q===null||Q===void 0?void 0:Q.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:X,parsedType:u(X)},J=this._parse({data:X,path:W.path,parent:W}),G=await(E0(J)?J:Promise.resolve(J));return N1(W,G)}refine(X,Q){let W=(J)=>{if(typeof Q==="string"||typeof Q==="undefined")return{message:Q};else if(typeof Q==="function")return Q(J);else return Q};return this._refinement((J,G)=>{let Y=X(J),H=()=>G.addIssue({code:M.custom,...W(J)});if(typeof Promise!=="undefined"&&Y instanceof Promise)return Y.then((B)=>{if(!B)return H(),!1;else return!0});if(!Y)return H(),!1;else return!0})}refinement(X,Q){return this._refinement((W,J)=>{if(!X(W))return J.addIssue(typeof Q==="function"?Q(W,J):Q),!1;else return!0})}_refinement(X){return new I({schema:this,typeName:O.ZodEffects,effect:{type:"refinement",refinement:X}})}superRefine(X){return this._refinement(X)}constructor(X){this.spa=this.safeParseAsync,this._def=X,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:(Q)=>this["~validate"](Q)}}optional(){return T.create(this,this._def)}nullable(){return p.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return P.create(this)}promise(){return Q0.create(this,this._def)}or(X){return V0.create([this,X],this._def)}and(X){return L0.create(this,X,this._def)}transform(X){return new I({...A(this._def),schema:this,typeName:O.ZodEffects,effect:{type:"transform",transform:X}})}default(X){let Q=typeof X==="function"?X:()=>X;return new A0({...A(this._def),innerType:this,defaultValue:Q,typeName:O.ZodDefault})}brand(){return new y0({typeName:O.ZodBranded,type:this,...A(this._def)})}catch(X){let Q=typeof X==="function"?X:()=>X;return new K0({...A(this._def),innerType:this,catchValue:Q,typeName:O.ZodCatch})}describe(X){return new this.constructor({...this._def,description:X})}pipe(X){return I0.create(this,X)}readonly(){return j0.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}var O4=/^c[^\s-]{8,}$/i,q4=/^[0-9a-z]+$/,A4=/^[0-9A-HJKMNP-TV-Z]{26}$/i,K4=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,j4=/^[a-z0-9_-]{21}$/i,F4=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,R4=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,D4=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,N4="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",o0,S4=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,E4=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,_4=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,C4=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,v4=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,k4=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,v1="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",b4=new RegExp(`^${v1}$`);function k1(X){let Q="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";if(X.precision)Q=`${Q}\\.\\d{${X.precision}}`;else if(X.precision==null)Q=`${Q}(\\.\\d+)?`;return Q}function I4(X){return new RegExp(`^${k1(X)}$`)}function b1(X){let Q=`${v1}T${k1(X)}`,W=[];if(W.push(X.local?"Z?":"Z"),X.offset)W.push("([+-]\\d{2}:?\\d{2})");return Q=`${Q}(${W.join("|")})`,new RegExp(`^${Q}$`)}function f4(X,Q){if((Q==="v4"||!Q)&&S4.test(X))return!0;if((Q==="v6"||!Q)&&_4.test(X))return!0;return!1}function P4(X,Q){if(!F4.test(X))return!1;try{let[W]=X.split("."),J=W.replace(/-/g,"+").replace(/_/g,"/").padEnd(W.length+(4-W.length%4)%4,"="),G=JSON.parse(atob(J));if(typeof G!=="object"||G===null)return!1;if(!G.typ||!G.alg)return!1;if(Q&&G.alg!==Q)return!1;return!0}catch(W){return!1}}function T4(X,Q){if((Q==="v4"||!Q)&&E4.test(X))return!0;if((Q==="v6"||!Q)&&C4.test(X))return!0;return!1}class f extends K{_parse(X){if(this._def.coerce)X.data=String(X.data);if(this._getType(X)!==L.string){let G=this._getOrReturnCtx(X);return V(G,{code:M.invalid_type,expected:L.string,received:G.parsedType}),q}let W=new S,J=void 0;for(let G of this._def.checks)if(G.kind==="min"){if(X.data.length<G.value)J=this._getOrReturnCtx(X,J),V(J,{code:M.too_small,minimum:G.value,type:"string",inclusive:!0,exact:!1,message:G.message}),W.dirty()}else if(G.kind==="max"){if(X.data.length>G.value)J=this._getOrReturnCtx(X,J),V(J,{code:M.too_big,maximum:G.value,type:"string",inclusive:!0,exact:!1,message:G.message}),W.dirty()}else if(G.kind==="length"){let Y=X.data.length>G.value,H=X.data.length<G.value;if(Y||H){if(J=this._getOrReturnCtx(X,J),Y)V(J,{code:M.too_big,maximum:G.value,type:"string",inclusive:!0,exact:!0,message:G.message});else if(H)V(J,{code:M.too_small,minimum:G.value,type:"string",inclusive:!0,exact:!0,message:G.message});W.dirty()}}else if(G.kind==="email"){if(!D4.test(X.data))J=this._getOrReturnCtx(X,J),V(J,{validation:"email",code:M.invalid_string,message:G.message}),W.dirty()}else if(G.kind==="emoji"){if(!o0)o0=new RegExp(N4,"u");if(!o0.test(X.data))J=this._getOrReturnCtx(X,J),V(J,{validation:"emoji",code:M.invalid_string,message:G.message}),W.dirty()}else if(G.kind==="uuid"){if(!K4.test(X.data))J=this._getOrReturnCtx(X,J),V(J,{validation:"uuid",code:M.invalid_string,message:G.message}),W.dirty()}else if(G.kind==="nanoid"){if(!j4.test(X.data))J=this._getOrReturnCtx(X,J),V(J,{validation:"nanoid",code:M.invalid_string,message:G.message}),W.dirty()}else if(G.kind==="cuid"){if(!O4.test(X.data))J=this._getOrReturnCtx(X,J),V(J,{validation:"cuid",code:M.invalid_string,message:G.message}),W.dirty()}else if(G.kind==="cuid2"){if(!q4.test(X.data))J=this._getOrReturnCtx(X,J),V(J,{validation:"cuid2",code:M.invalid_string,message:G.message}),W.dirty()}else if(G.kind==="ulid"){if(!A4.test(X.data))J=this._getOrReturnCtx(X,J),V(J,{validation:"ulid",code:M.invalid_string,message:G.message}),W.dirty()}else if(G.kind==="url")try{new URL(X.data)}catch(Y){J=this._getOrReturnCtx(X,J),V(J,{validation:"url",code:M.invalid_string,message:G.message}),W.dirty()}else if(G.kind==="regex"){if(G.regex.lastIndex=0,!G.regex.test(X.data))J=this._getOrReturnCtx(X,J),V(J,{validation:"regex",code:M.invalid_string,message:G.message}),W.dirty()}else if(G.kind==="trim")X.data=X.data.trim();else if(G.kind==="includes"){if(!X.data.includes(G.value,G.position))J=this._getOrReturnCtx(X,J),V(J,{code:M.invalid_string,validation:{includes:G.value,position:G.position},message:G.message}),W.dirty()}else if(G.kind==="toLowerCase")X.data=X.data.toLowerCase();else if(G.kind==="toUpperCase")X.data=X.data.toUpperCase();else if(G.kind==="startsWith"){if(!X.data.startsWith(G.value))J=this._getOrReturnCtx(X,J),V(J,{code:M.invalid_string,validation:{startsWith:G.value},message:G.message}),W.dirty()}else if(G.kind==="endsWith"){if(!X.data.endsWith(G.value))J=this._getOrReturnCtx(X,J),V(J,{code:M.invalid_string,validation:{endsWith:G.value},message:G.message}),W.dirty()}else if(G.kind==="datetime"){if(!b1(G).test(X.data))J=this._getOrReturnCtx(X,J),V(J,{code:M.invalid_string,validation:"datetime",message:G.message}),W.dirty()}else if(G.kind==="date"){if(!b4.test(X.data))J=this._getOrReturnCtx(X,J),V(J,{code:M.invalid_string,validation:"date",message:G.message}),W.dirty()}else if(G.kind==="time"){if(!I4(G).test(X.data))J=this._getOrReturnCtx(X,J),V(J,{code:M.invalid_string,validation:"time",message:G.message}),W.dirty()}else if(G.kind==="duration"){if(!R4.test(X.data))J=this._getOrReturnCtx(X,J),V(J,{validation:"duration",code:M.invalid_string,message:G.message}),W.dirty()}else if(G.kind==="ip"){if(!f4(X.data,G.version))J=this._getOrReturnCtx(X,J),V(J,{validation:"ip",code:M.invalid_string,message:G.message}),W.dirty()}else if(G.kind==="jwt"){if(!P4(X.data,G.alg))J=this._getOrReturnCtx(X,J),V(J,{validation:"jwt",code:M.invalid_string,message:G.message}),W.dirty()}else if(G.kind==="cidr"){if(!T4(X.data,G.version))J=this._getOrReturnCtx(X,J),V(J,{validation:"cidr",code:M.invalid_string,message:G.message}),W.dirty()}else if(G.kind==="base64"){if(!v4.test(X.data))J=this._getOrReturnCtx(X,J),V(J,{validation:"base64",code:M.invalid_string,message:G.message}),W.dirty()}else if(G.kind==="base64url"){if(!k4.test(X.data))J=this._getOrReturnCtx(X,J),V(J,{validation:"base64url",code:M.invalid_string,message:G.message}),W.dirty()}else F.assertNever(G);return{status:W.value,value:X.data}}_regex(X,Q,W){return this.refinement((J)=>X.test(J),{validation:Q,code:M.invalid_string,...U.errToObj(W)})}_addCheck(X){return new f({...this._def,checks:[...this._def.checks,X]})}email(X){return this._addCheck({kind:"email",...U.errToObj(X)})}url(X){return this._addCheck({kind:"url",...U.errToObj(X)})}emoji(X){return this._addCheck({kind:"emoji",...U.errToObj(X)})}uuid(X){return this._addCheck({kind:"uuid",...U.errToObj(X)})}nanoid(X){return this._addCheck({kind:"nanoid",...U.errToObj(X)})}cuid(X){return this._addCheck({kind:"cuid",...U.errToObj(X)})}cuid2(X){return this._addCheck({kind:"cuid2",...U.errToObj(X)})}ulid(X){return this._addCheck({kind:"ulid",...U.errToObj(X)})}base64(X){return this._addCheck({kind:"base64",...U.errToObj(X)})}base64url(X){return this._addCheck({kind:"base64url",...U.errToObj(X)})}jwt(X){return this._addCheck({kind:"jwt",...U.errToObj(X)})}ip(X){return this._addCheck({kind:"ip",...U.errToObj(X)})}cidr(X){return this._addCheck({kind:"cidr",...U.errToObj(X)})}datetime(X){var Q,W;if(typeof X==="string")return this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:X});return this._addCheck({kind:"datetime",precision:typeof(X===null||X===void 0?void 0:X.precision)==="undefined"?null:X===null||X===void 0?void 0:X.precision,offset:(Q=X===null||X===void 0?void 0:X.offset)!==null&&Q!==void 0?Q:!1,local:(W=X===null||X===void 0?void 0:X.local)!==null&&W!==void 0?W:!1,...U.errToObj(X===null||X===void 0?void 0:X.message)})}date(X){return this._addCheck({kind:"date",message:X})}time(X){if(typeof X==="string")return this._addCheck({kind:"time",precision:null,message:X});return this._addCheck({kind:"time",precision:typeof(X===null||X===void 0?void 0:X.precision)==="undefined"?null:X===null||X===void 0?void 0:X.precision,...U.errToObj(X===null||X===void 0?void 0:X.message)})}duration(X){return this._addCheck({kind:"duration",...U.errToObj(X)})}regex(X,Q){return this._addCheck({kind:"regex",regex:X,...U.errToObj(Q)})}includes(X,Q){return this._addCheck({kind:"includes",value:X,position:Q===null||Q===void 0?void 0:Q.position,...U.errToObj(Q===null||Q===void 0?void 0:Q.message)})}startsWith(X,Q){return this._addCheck({kind:"startsWith",value:X,...U.errToObj(Q)})}endsWith(X,Q){return this._addCheck({kind:"endsWith",value:X,...U.errToObj(Q)})}min(X,Q){return this._addCheck({kind:"min",value:X,...U.errToObj(Q)})}max(X,Q){return this._addCheck({kind:"max",value:X,...U.errToObj(Q)})}length(X,Q){return this._addCheck({kind:"length",value:X,...U.errToObj(Q)})}nonempty(X){return this.min(1,U.errToObj(X))}trim(){return new f({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new f({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new f({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find((X)=>X.kind==="datetime")}get isDate(){return!!this._def.checks.find((X)=>X.kind==="date")}get isTime(){return!!this._def.checks.find((X)=>X.kind==="time")}get isDuration(){return!!this._def.checks.find((X)=>X.kind==="duration")}get isEmail(){return!!this._def.checks.find((X)=>X.kind==="email")}get isURL(){return!!this._def.checks.find((X)=>X.kind==="url")}get isEmoji(){return!!this._def.checks.find((X)=>X.kind==="emoji")}get isUUID(){return!!this._def.checks.find((X)=>X.kind==="uuid")}get isNANOID(){return!!this._def.checks.find((X)=>X.kind==="nanoid")}get isCUID(){return!!this._def.checks.find((X)=>X.kind==="cuid")}get isCUID2(){return!!this._def.checks.find((X)=>X.kind==="cuid2")}get isULID(){return!!this._def.checks.find((X)=>X.kind==="ulid")}get isIP(){return!!this._def.checks.find((X)=>X.kind==="ip")}get isCIDR(){return!!this._def.checks.find((X)=>X.kind==="cidr")}get isBase64(){return!!this._def.checks.find((X)=>X.kind==="base64")}get isBase64url(){return!!this._def.checks.find((X)=>X.kind==="base64url")}get minLength(){let X=null;for(let Q of this._def.checks)if(Q.kind==="min"){if(X===null||Q.value>X)X=Q.value}return X}get maxLength(){let X=null;for(let Q of this._def.checks)if(Q.kind==="max"){if(X===null||Q.value<X)X=Q.value}return X}}f.create=(X)=>{var Q;return new f({checks:[],typeName:O.ZodString,coerce:(Q=X===null||X===void 0?void 0:X.coerce)!==null&&Q!==void 0?Q:!1,...A(X)})};function g4(X,Q){let W=(X.toString().split(".")[1]||"").length,J=(Q.toString().split(".")[1]||"").length,G=W>J?W:J,Y=parseInt(X.toFixed(G).replace(".","")),H=parseInt(Q.toFixed(G).replace(".",""));return Y%H/Math.pow(10,G)}class i extends K{constructor(){super(...arguments);this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(X){if(this._def.coerce)X.data=Number(X.data);if(this._getType(X)!==L.number){let G=this._getOrReturnCtx(X);return V(G,{code:M.invalid_type,expected:L.number,received:G.parsedType}),q}let W=void 0,J=new S;for(let G of this._def.checks)if(G.kind==="int"){if(!F.isInteger(X.data))W=this._getOrReturnCtx(X,W),V(W,{code:M.invalid_type,expected:"integer",received:"float",message:G.message}),J.dirty()}else if(G.kind==="min"){if(G.inclusive?X.data<G.value:X.data<=G.value)W=this._getOrReturnCtx(X,W),V(W,{code:M.too_small,minimum:G.value,type:"number",inclusive:G.inclusive,exact:!1,message:G.message}),J.dirty()}else if(G.kind==="max"){if(G.inclusive?X.data>G.value:X.data>=G.value)W=this._getOrReturnCtx(X,W),V(W,{code:M.too_big,maximum:G.value,type:"number",inclusive:G.inclusive,exact:!1,message:G.message}),J.dirty()}else if(G.kind==="multipleOf"){if(g4(X.data,G.value)!==0)W=this._getOrReturnCtx(X,W),V(W,{code:M.not_multiple_of,multipleOf:G.value,message:G.message}),J.dirty()}else if(G.kind==="finite"){if(!Number.isFinite(X.data))W=this._getOrReturnCtx(X,W),V(W,{code:M.not_finite,message:G.message}),J.dirty()}else F.assertNever(G);return{status:J.value,value:X.data}}gte(X,Q){return this.setLimit("min",X,!0,U.toString(Q))}gt(X,Q){return this.setLimit("min",X,!1,U.toString(Q))}lte(X,Q){return this.setLimit("max",X,!0,U.toString(Q))}lt(X,Q){return this.setLimit("max",X,!1,U.toString(Q))}setLimit(X,Q,W,J){return new i({...this._def,checks:[...this._def.checks,{kind:X,value:Q,inclusive:W,message:U.toString(J)}]})}_addCheck(X){return new i({...this._def,checks:[...this._def.checks,X]})}int(X){return this._addCheck({kind:"int",message:U.toString(X)})}positive(X){return this._addCheck({kind:"min",value:0,inclusive:!1,message:U.toString(X)})}negative(X){return this._addCheck({kind:"max",value:0,inclusive:!1,message:U.toString(X)})}nonpositive(X){return this._addCheck({kind:"max",value:0,inclusive:!0,message:U.toString(X)})}nonnegative(X){return this._addCheck({kind:"min",value:0,inclusive:!0,message:U.toString(X)})}multipleOf(X,Q){return this._addCheck({kind:"multipleOf",value:X,message:U.toString(Q)})}finite(X){return this._addCheck({kind:"finite",message:U.toString(X)})}safe(X){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:U.toString(X)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:U.toString(X)})}get minValue(){let X=null;for(let Q of this._def.checks)if(Q.kind==="min"){if(X===null||Q.value>X)X=Q.value}return X}get maxValue(){let X=null;for(let Q of this._def.checks)if(Q.kind==="max"){if(X===null||Q.value<X)X=Q.value}return X}get isInt(){return!!this._def.checks.find((X)=>X.kind==="int"||X.kind==="multipleOf"&&F.isInteger(X.value))}get isFinite(){let X=null,Q=null;for(let W of this._def.checks)if(W.kind==="finite"||W.kind==="int"||W.kind==="multipleOf")return!0;else if(W.kind==="min"){if(Q===null||W.value>Q)Q=W.value}else if(W.kind==="max"){if(X===null||W.value<X)X=W.value}return Number.isFinite(Q)&&Number.isFinite(X)}}i.create=(X)=>{return new i({checks:[],typeName:O.ZodNumber,coerce:(X===null||X===void 0?void 0:X.coerce)||!1,...A(X)})};class r extends K{constructor(){super(...arguments);this.min=this.gte,this.max=this.lte}_parse(X){if(this._def.coerce)try{X.data=BigInt(X.data)}catch(G){return this._getInvalidInput(X)}if(this._getType(X)!==L.bigint)return this._getInvalidInput(X);let W=void 0,J=new S;for(let G of this._def.checks)if(G.kind==="min"){if(G.inclusive?X.data<G.value:X.data<=G.value)W=this._getOrReturnCtx(X,W),V(W,{code:M.too_small,type:"bigint",minimum:G.value,inclusive:G.inclusive,message:G.message}),J.dirty()}else if(G.kind==="max"){if(G.inclusive?X.data>G.value:X.data>=G.value)W=this._getOrReturnCtx(X,W),V(W,{code:M.too_big,type:"bigint",maximum:G.value,inclusive:G.inclusive,message:G.message}),J.dirty()}else if(G.kind==="multipleOf"){if(X.data%G.value!==BigInt(0))W=this._getOrReturnCtx(X,W),V(W,{code:M.not_multiple_of,multipleOf:G.value,message:G.message}),J.dirty()}else F.assertNever(G);return{status:J.value,value:X.data}}_getInvalidInput(X){let Q=this._getOrReturnCtx(X);return V(Q,{code:M.invalid_type,expected:L.bigint,received:Q.parsedType}),q}gte(X,Q){return this.setLimit("min",X,!0,U.toString(Q))}gt(X,Q){return this.setLimit("min",X,!1,U.toString(Q))}lte(X,Q){return this.setLimit("max",X,!0,U.toString(Q))}lt(X,Q){return this.setLimit("max",X,!1,U.toString(Q))}setLimit(X,Q,W,J){return new r({...this._def,checks:[...this._def.checks,{kind:X,value:Q,inclusive:W,message:U.toString(J)}]})}_addCheck(X){return new r({...this._def,checks:[...this._def.checks,X]})}positive(X){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:U.toString(X)})}negative(X){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:U.toString(X)})}nonpositive(X){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:U.toString(X)})}nonnegative(X){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:U.toString(X)})}multipleOf(X,Q){return this._addCheck({kind:"multipleOf",value:X,message:U.toString(Q)})}get minValue(){let X=null;for(let Q of this._def.checks)if(Q.kind==="min"){if(X===null||Q.value>X)X=Q.value}return X}get maxValue(){let X=null;for(let Q of this._def.checks)if(Q.kind==="max"){if(X===null||Q.value<X)X=Q.value}return X}}r.create=(X)=>{var Q;return new r({checks:[],typeName:O.ZodBigInt,coerce:(Q=X===null||X===void 0?void 0:X.coerce)!==null&&Q!==void 0?Q:!1,...A(X)})};class M0 extends K{_parse(X){if(this._def.coerce)X.data=Boolean(X.data);if(this._getType(X)!==L.boolean){let W=this._getOrReturnCtx(X);return V(W,{code:M.invalid_type,expected:L.boolean,received:W.parsedType}),q}return E(X.data)}}M0.create=(X)=>{return new M0({typeName:O.ZodBoolean,coerce:(X===null||X===void 0?void 0:X.coerce)||!1,...A(X)})};class t extends K{_parse(X){if(this._def.coerce)X.data=new Date(X.data);if(this._getType(X)!==L.date){let G=this._getOrReturnCtx(X);return V(G,{code:M.invalid_type,expected:L.date,received:G.parsedType}),q}if(isNaN(X.data.getTime())){let G=this._getOrReturnCtx(X);return V(G,{code:M.invalid_date}),q}let W=new S,J=void 0;for(let G of this._def.checks)if(G.kind==="min"){if(X.data.getTime()<G.value)J=this._getOrReturnCtx(X,J),V(J,{code:M.too_small,message:G.message,inclusive:!0,exact:!1,minimum:G.value,type:"date"}),W.dirty()}else if(G.kind==="max"){if(X.data.getTime()>G.value)J=this._getOrReturnCtx(X,J),V(J,{code:M.too_big,message:G.message,inclusive:!0,exact:!1,maximum:G.value,type:"date"}),W.dirty()}else F.assertNever(G);return{status:W.value,value:new Date(X.data.getTime())}}_addCheck(X){return new t({...this._def,checks:[...this._def.checks,X]})}min(X,Q){return this._addCheck({kind:"min",value:X.getTime(),message:U.toString(Q)})}max(X,Q){return this._addCheck({kind:"max",value:X.getTime(),message:U.toString(Q)})}get minDate(){let X=null;for(let Q of this._def.checks)if(Q.kind==="min"){if(X===null||Q.value>X)X=Q.value}return X!=null?new Date(X):null}get maxDate(){let X=null;for(let Q of this._def.checks)if(Q.kind==="max"){if(X===null||Q.value<X)X=Q.value}return X!=null?new Date(X):null}}t.create=(X)=>{return new t({checks:[],coerce:(X===null||X===void 0?void 0:X.coerce)||!1,typeName:O.ZodDate,...A(X)})};class _0 extends K{_parse(X){if(this._getType(X)!==L.symbol){let W=this._getOrReturnCtx(X);return V(W,{code:M.invalid_type,expected:L.symbol,received:W.parsedType}),q}return E(X.data)}}_0.create=(X)=>{return new _0({typeName:O.ZodSymbol,...A(X)})};class z0 extends K{_parse(X){if(this._getType(X)!==L.undefined){let W=this._getOrReturnCtx(X);return V(W,{code:M.invalid_type,expected:L.undefined,received:W.parsedType}),q}return E(X.data)}}z0.create=(X)=>{return new z0({typeName:O.ZodUndefined,...A(X)})};class w0 extends K{_parse(X){if(this._getType(X)!==L.null){let W=this._getOrReturnCtx(X);return V(W,{code:M.invalid_type,expected:L.null,received:W.parsedType}),q}return E(X.data)}}w0.create=(X)=>{return new w0({typeName:O.ZodNull,...A(X)})};class e extends K{constructor(){super(...arguments);this._any=!0}_parse(X){return E(X.data)}}e.create=(X)=>{return new e({typeName:O.ZodAny,...A(X)})};class d extends K{constructor(){super(...arguments);this._unknown=!0}_parse(X){return E(X.data)}}d.create=(X)=>{return new d({typeName:O.ZodUnknown,...A(X)})};class y extends K{_parse(X){let Q=this._getOrReturnCtx(X);return V(Q,{code:M.invalid_type,expected:L.never,received:Q.parsedType}),q}}y.create=(X)=>{return new y({typeName:O.ZodNever,...A(X)})};class C0 extends K{_parse(X){if(this._getType(X)!==L.undefined){let W=this._getOrReturnCtx(X);return V(W,{code:M.invalid_type,expected:L.void,received:W.parsedType}),q}return E(X.data)}}C0.create=(X)=>{return new C0({typeName:O.ZodVoid,...A(X)})};class P extends K{_parse(X){let{ctx:Q,status:W}=this._processInputParams(X),J=this._def;if(Q.parsedType!==L.array)return V(Q,{code:M.invalid_type,expected:L.array,received:Q.parsedType}),q;if(J.exactLength!==null){let Y=Q.data.length>J.exactLength.value,H=Q.data.length<J.exactLength.value;if(Y||H)V(Q,{code:Y?M.too_big:M.too_small,minimum:H?J.exactLength.value:void 0,maximum:Y?J.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:J.exactLength.message}),W.dirty()}if(J.minLength!==null){if(Q.data.length<J.minLength.value)V(Q,{code:M.too_small,minimum:J.minLength.value,type:"array",inclusive:!0,exact:!1,message:J.minLength.message}),W.dirty()}if(J.maxLength!==null){if(Q.data.length>J.maxLength.value)V(Q,{code:M.too_big,maximum:J.maxLength.value,type:"array",inclusive:!0,exact:!1,message:J.maxLength.message}),W.dirty()}if(Q.common.async)return Promise.all([...Q.data].map((Y,H)=>{return J.type._parseAsync(new g(Q,Y,Q.path,H))})).then((Y)=>{return S.mergeArray(W,Y)});let G=[...Q.data].map((Y,H)=>{return J.type._parseSync(new g(Q,Y,Q.path,H))});return S.mergeArray(W,G)}get element(){return this._def.type}min(X,Q){return new P({...this._def,minLength:{value:X,message:U.toString(Q)}})}max(X,Q){return new P({...this._def,maxLength:{value:X,message:U.toString(Q)}})}length(X,Q){return new P({...this._def,exactLength:{value:X,message:U.toString(Q)}})}nonempty(X){return this.min(1,X)}}P.create=(X,Q)=>{return new P({type:X,minLength:null,maxLength:null,exactLength:null,typeName:O.ZodArray,...A(Q)})};function $0(X){if(X instanceof R){let Q={};for(let W in X.shape){let J=X.shape[W];Q[W]=T.create($0(J))}return new R({...X._def,shape:()=>Q})}else if(X instanceof P)return new P({...X._def,type:$0(X.element)});else if(X instanceof T)return T.create($0(X.unwrap()));else if(X instanceof p)return p.create($0(X.unwrap()));else if(X instanceof Z)return Z.create(X.items.map((Q)=>$0(Q)));else return X}class R extends K{constructor(){super(...arguments);this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let X=this._def.shape(),Q=F.objectKeys(X);return this._cached={shape:X,keys:Q}}_parse(X){if(this._getType(X)!==L.object){let z=this._getOrReturnCtx(X);return V(z,{code:M.invalid_type,expected:L.object,received:z.parsedType}),q}let{status:W,ctx:J}=this._processInputParams(X),{shape:G,keys:Y}=this._getCached(),H=[];if(!(this._def.catchall instanceof y&&this._def.unknownKeys==="strip")){for(let z in J.data)if(!Y.includes(z))H.push(z)}let B=[];for(let z of Y){let w=G[z],j=J.data[z];B.push({key:{status:"valid",value:z},value:w._parse(new g(J,j,J.path,z)),alwaysSet:z in J.data})}if(this._def.catchall instanceof y){let z=this._def.unknownKeys;if(z==="passthrough")for(let w of H)B.push({key:{status:"valid",value:w},value:{status:"valid",value:J.data[w]}});else if(z==="strict"){if(H.length>0)V(J,{code:M.unrecognized_keys,keys:H}),W.dirty()}else if(z==="strip");else throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let z=this._def.catchall;for(let w of H){let j=J.data[w];B.push({key:{status:"valid",value:w},value:z._parse(new g(J,j,J.path,w)),alwaysSet:w in J.data})}}if(J.common.async)return Promise.resolve().then(async()=>{let z=[];for(let w of B){let j=await w.key,C=await w.value;z.push({key:j,value:C,alwaysSet:w.alwaysSet})}return z}).then((z)=>{return S.mergeObjectSync(W,z)});else return S.mergeObjectSync(W,B)}get shape(){return this._def.shape()}strict(X){return U.errToObj,new R({...this._def,unknownKeys:"strict",...X!==void 0?{errorMap:(Q,W)=>{var J,G,Y,H;let B=(Y=(G=(J=this._def).errorMap)===null||G===void 0?void 0:G.call(J,Q,W).message)!==null&&Y!==void 0?Y:W.defaultError;if(Q.code==="unrecognized_keys")return{message:(H=U.errToObj(X).message)!==null&&H!==void 0?H:B};return{message:B}}}:{}})}strip(){return new R({...this._def,unknownKeys:"strip"})}passthrough(){return new R({...this._def,unknownKeys:"passthrough"})}extend(X){return new R({...this._def,shape:()=>({...this._def.shape(),...X})})}merge(X){return new R({unknownKeys:X._def.unknownKeys,catchall:X._def.catchall,shape:()=>({...this._def.shape(),...X._def.shape()}),typeName:O.ZodObject})}setKey(X,Q){return this.augment({[X]:Q})}catchall(X){return new R({...this._def,catchall:X})}pick(X){let Q={};return F.objectKeys(X).forEach((W)=>{if(X[W]&&this.shape[W])Q[W]=this.shape[W]}),new R({...this._def,shape:()=>Q})}omit(X){let Q={};return F.objectKeys(this.shape).forEach((W)=>{if(!X[W])Q[W]=this.shape[W]}),new R({...this._def,shape:()=>Q})}deepPartial(){return $0(this)}partial(X){let Q={};return F.objectKeys(this.shape).forEach((W)=>{let J=this.shape[W];if(X&&!X[W])Q[W]=J;else Q[W]=J.optional()}),new R({...this._def,shape:()=>Q})}required(X){let Q={};return F.objectKeys(this.shape).forEach((W)=>{if(X&&!X[W])Q[W]=this.shape[W];else{let G=this.shape[W];while(G instanceof T)G=G._def.innerType;Q[W]=G}}),new R({...this._def,shape:()=>Q})}keyof(){return I1(F.objectKeys(this.shape))}}R.create=(X,Q)=>{return new R({shape:()=>X,unknownKeys:"strip",catchall:y.create(),typeName:O.ZodObject,...A(Q)})};R.strictCreate=(X,Q)=>{return new R({shape:()=>X,unknownKeys:"strict",catchall:y.create(),typeName:O.ZodObject,...A(Q)})};R.lazycreate=(X,Q)=>{return new R({shape:X,unknownKeys:"strip",catchall:y.create(),typeName:O.ZodObject,...A(Q)})};class V0 extends K{_parse(X){let{ctx:Q}=this._processInputParams(X),W=this._def.options;function J(G){for(let H of G)if(H.result.status==="valid")return H.result;for(let H of G)if(H.result.status==="dirty")return Q.common.issues.push(...H.ctx.common.issues),H.result;let Y=G.map((H)=>new v(H.ctx.common.issues));return V(Q,{code:M.invalid_union,unionErrors:Y}),q}if(Q.common.async)return Promise.all(W.map(async(G)=>{let Y={...Q,common:{...Q.common,issues:[]},parent:null};return{result:await G._parseAsync({data:Q.data,path:Q.path,parent:Y}),ctx:Y}})).then(J);else{let G=void 0,Y=[];for(let B of W){let z={...Q,common:{...Q.common,issues:[]},parent:null},w=B._parseSync({data:Q.data,path:Q.path,parent:z});if(w.status==="valid")return w;else if(w.status==="dirty"&&!G)G={result:w,ctx:z};if(z.common.issues.length)Y.push(z.common.issues)}if(G)return Q.common.issues.push(...G.ctx.common.issues),G.result;let H=Y.map((B)=>new v(B));return V(Q,{code:M.invalid_union,unionErrors:H}),q}}get options(){return this._def.options}}V0.create=(X,Q)=>{return new V0({options:X,typeName:O.ZodUnion,...A(Q)})};var c=(X)=>{if(X instanceof U0)return c(X.schema);else if(X instanceof I)return c(X.innerType());else if(X instanceof O0)return[X.value];else if(X instanceof o)return X.options;else if(X instanceof q0)return F.objectValues(X.enum);else if(X instanceof A0)return c(X._def.innerType);else if(X instanceof z0)return[void 0];else if(X instanceof w0)return[null];else if(X instanceof T)return[void 0,...c(X.unwrap())];else if(X instanceof p)return[null,...c(X.unwrap())];else if(X instanceof y0)return c(X.unwrap());else if(X instanceof j0)return c(X.unwrap());else if(X instanceof K0)return c(X._def.innerType);else return[]};class h0 extends K{_parse(X){let{ctx:Q}=this._processInputParams(X);if(Q.parsedType!==L.object)return V(Q,{code:M.invalid_type,expected:L.object,received:Q.parsedType}),q;let W=this.discriminator,J=Q.data[W],G=this.optionsMap.get(J);if(!G)return V(Q,{code:M.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[W]}),q;if(Q.common.async)return G._parseAsync({data:Q.data,path:Q.path,parent:Q});else return G._parseSync({data:Q.data,path:Q.path,parent:Q})}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(X,Q,W){let J=new Map;for(let G of Q){let Y=c(G.shape[X]);if(!Y.length)throw new Error(`A discriminator value for key \`${X}\` could not be extracted from all schema options`);for(let H of Y){if(J.has(H))throw new Error(`Discriminator property ${String(X)} has duplicate value ${String(H)}`);J.set(H,G)}}return new h0({typeName:O.ZodDiscriminatedUnion,discriminator:X,options:Q,optionsMap:J,...A(W)})}}function e0(X,Q){let W=u(X),J=u(Q);if(X===Q)return{valid:!0,data:X};else if(W===L.object&&J===L.object){let G=F.objectKeys(Q),Y=F.objectKeys(X).filter((B)=>G.indexOf(B)!==-1),H={...X,...Q};for(let B of Y){let z=e0(X[B],Q[B]);if(!z.valid)return{valid:!1};H[B]=z.data}return{valid:!0,data:H}}else if(W===L.array&&J===L.array){if(X.length!==Q.length)return{valid:!1};let G=[];for(let Y=0;Y<X.length;Y++){let H=X[Y],B=Q[Y],z=e0(H,B);if(!z.valid)return{valid:!1};G.push(z.data)}return{valid:!0,data:G}}else if(W===L.date&&J===L.date&&+X===+Q)return{valid:!0,data:X};else return{valid:!1}}class L0 extends K{_parse(X){let{status:Q,ctx:W}=this._processInputParams(X),J=(G,Y)=>{if(s0(G)||s0(Y))return q;let H=e0(G.value,Y.value);if(!H.valid)return V(W,{code:M.invalid_intersection_types}),q;if(t0(G)||t0(Y))Q.dirty();return{status:Q.value,value:H.data}};if(W.common.async)return Promise.all([this._def.left._parseAsync({data:W.data,path:W.path,parent:W}),this._def.right._parseAsync({data:W.data,path:W.path,parent:W})]).then(([G,Y])=>J(G,Y));else return J(this._def.left._parseSync({data:W.data,path:W.path,parent:W}),this._def.right._parseSync({data:W.data,path:W.path,parent:W}))}}L0.create=(X,Q,W)=>{return new L0({left:X,right:Q,typeName:O.ZodIntersection,...A(W)})};class Z extends K{_parse(X){let{status:Q,ctx:W}=this._processInputParams(X);if(W.parsedType!==L.array)return V(W,{code:M.invalid_type,expected:L.array,received:W.parsedType}),q;if(W.data.length<this._def.items.length)return V(W,{code:M.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),q;if(!this._def.rest&&W.data.length>this._def.items.length)V(W,{code:M.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Q.dirty();let G=[...W.data].map((Y,H)=>{let B=this._def.items[H]||this._def.rest;if(!B)return null;return B._parse(new g(W,Y,W.path,H))}).filter((Y)=>!!Y);if(W.common.async)return Promise.all(G).then((Y)=>{return S.mergeArray(Q,Y)});else return S.mergeArray(Q,G)}get items(){return this._def.items}rest(X){return new Z({...this._def,rest:X})}}Z.create=(X,Q)=>{if(!Array.isArray(X))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Z({items:X,typeName:O.ZodTuple,rest:null,...A(Q)})};class v0 extends K{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(X){let{status:Q,ctx:W}=this._processInputParams(X);if(W.parsedType!==L.object)return V(W,{code:M.invalid_type,expected:L.object,received:W.parsedType}),q;let J=[],G=this._def.keyType,Y=this._def.valueType;for(let H in W.data)J.push({key:G._parse(new g(W,H,W.path,H)),value:Y._parse(new g(W,W.data[H],W.path,H)),alwaysSet:H in W.data});if(W.common.async)return S.mergeObjectAsync(Q,J);else return S.mergeObjectSync(Q,J)}get element(){return this._def.valueType}static create(X,Q,W){if(Q instanceof K)return new v0({keyType:X,valueType:Q,typeName:O.ZodRecord,...A(W)});return new v0({keyType:f.create(),valueType:X,typeName:O.ZodRecord,...A(Q)})}}class k0 extends K{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(X){let{status:Q,ctx:W}=this._processInputParams(X);if(W.parsedType!==L.map)return V(W,{code:M.invalid_type,expected:L.map,received:W.parsedType}),q;let J=this._def.keyType,G=this._def.valueType,Y=[...W.data.entries()].map(([H,B],z)=>{return{key:J._parse(new g(W,H,W.path,[z,"key"])),value:G._parse(new g(W,B,W.path,[z,"value"]))}});if(W.common.async){let H=new Map;return Promise.resolve().then(async()=>{for(let B of Y){let z=await B.key,w=await B.value;if(z.status==="aborted"||w.status==="aborted")return q;if(z.status==="dirty"||w.status==="dirty")Q.dirty();H.set(z.value,w.value)}return{status:Q.value,value:H}})}else{let H=new Map;for(let B of Y){let{key:z,value:w}=B;if(z.status==="aborted"||w.status==="aborted")return q;if(z.status==="dirty"||w.status==="dirty")Q.dirty();H.set(z.value,w.value)}return{status:Q.value,value:H}}}}k0.create=(X,Q,W)=>{return new k0({valueType:Q,keyType:X,typeName:O.ZodMap,...A(W)})};class X0 extends K{_parse(X){let{status:Q,ctx:W}=this._processInputParams(X);if(W.parsedType!==L.set)return V(W,{code:M.invalid_type,expected:L.set,received:W.parsedType}),q;let J=this._def;if(J.minSize!==null){if(W.data.size<J.minSize.value)V(W,{code:M.too_small,minimum:J.minSize.value,type:"set",inclusive:!0,exact:!1,message:J.minSize.message}),Q.dirty()}if(J.maxSize!==null){if(W.data.size>J.maxSize.value)V(W,{code:M.too_big,maximum:J.maxSize.value,type:"set",inclusive:!0,exact:!1,message:J.maxSize.message}),Q.dirty()}let G=this._def.valueType;function Y(B){let z=new Set;for(let w of B){if(w.status==="aborted")return q;if(w.status==="dirty")Q.dirty();z.add(w.value)}return{status:Q.value,value:z}}let H=[...W.data.values()].map((B,z)=>G._parse(new g(W,B,W.path,z)));if(W.common.async)return Promise.all(H).then((B)=>Y(B));else return Y(H)}min(X,Q){return new X0({...this._def,minSize:{value:X,message:U.toString(Q)}})}max(X,Q){return new X0({...this._def,maxSize:{value:X,message:U.toString(Q)}})}size(X,Q){return this.min(X,Q).max(X,Q)}nonempty(X){return this.min(1,X)}}X0.create=(X,Q)=>{return new X0({valueType:X,minSize:null,maxSize:null,typeName:O.ZodSet,...A(Q)})};class H0 extends K{constructor(){super(...arguments);this.validate=this.implement}_parse(X){let{ctx:Q}=this._processInputParams(X);if(Q.parsedType!==L.function)return V(Q,{code:M.invalid_type,expected:L.function,received:Q.parsedType}),q;function W(H,B){return g0({data:H,path:Q.path,errorMaps:[Q.common.contextualErrorMap,Q.schemaErrorMap,T0(),B0].filter((z)=>!!z),issueData:{code:M.invalid_arguments,argumentsError:B}})}function J(H,B){return g0({data:H,path:Q.path,errorMaps:[Q.common.contextualErrorMap,Q.schemaErrorMap,T0(),B0].filter((z)=>!!z),issueData:{code:M.invalid_return_type,returnTypeError:B}})}let G={errorMap:Q.common.contextualErrorMap},Y=Q.data;if(this._def.returns instanceof Q0){let H=this;return E(async function(...B){let z=new v([]),w=await H._def.args.parseAsync(B,G).catch((n)=>{throw z.addIssue(W(B,n)),z}),j=await Reflect.apply(Y,this,w);return await H._def.returns._def.type.parseAsync(j,G).catch((n)=>{throw z.addIssue(J(j,n)),z})})}else{let H=this;return E(function(...B){let z=H._def.args.safeParse(B,G);if(!z.success)throw new v([W(B,z.error)]);let w=Reflect.apply(Y,this,z.data),j=H._def.returns.safeParse(w,G);if(!j.success)throw new v([J(w,j.error)]);return j.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...X){return new H0({...this._def,args:Z.create(X).rest(d.create())})}returns(X){return new H0({...this._def,returns:X})}implement(X){return this.parse(X)}strictImplement(X){return this.parse(X)}static create(X,Q,W){return new H0({args:X?X:Z.create([]).rest(d.create()),returns:Q||d.create(),typeName:O.ZodFunction,...A(W)})}}class U0 extends K{get schema(){return this._def.getter()}_parse(X){let{ctx:Q}=this._processInputParams(X);return this._def.getter()._parse({data:Q.data,path:Q.path,parent:Q})}}U0.create=(X,Q)=>{return new U0({getter:X,typeName:O.ZodLazy,...A(Q)})};class O0 extends K{_parse(X){if(X.data!==this._def.value){let Q=this._getOrReturnCtx(X);return V(Q,{received:Q.data,code:M.invalid_literal,expected:this._def.value}),q}return{status:"valid",value:X.data}}get value(){return this._def.value}}O0.create=(X,Q)=>{return new O0({value:X,typeName:O.ZodLiteral,...A(Q)})};function I1(X,Q){return new o({values:X,typeName:O.ZodEnum,...A(Q)})}class o extends K{constructor(){super(...arguments);N0.set(this,void 0)}_parse(X){if(typeof X.data!=="string"){let Q=this._getOrReturnCtx(X),W=this._def.values;return V(Q,{expected:F.joinValues(W),received:Q.parsedType,code:M.invalid_type}),q}if(!x0(this,N0,"f"))C1(this,N0,new Set(this._def.values),"f");if(!x0(this,N0,"f").has(X.data)){let Q=this._getOrReturnCtx(X),W=this._def.values;return V(Q,{received:Q.data,code:M.invalid_enum_value,options:W}),q}return E(X.data)}get options(){return this._def.values}get enum(){let X={};for(let Q of this._def.values)X[Q]=Q;return X}get Values(){let X={};for(let Q of this._def.values)X[Q]=Q;return X}get Enum(){let X={};for(let Q of this._def.values)X[Q]=Q;return X}extract(X,Q=this._def){return o.create(X,{...this._def,...Q})}exclude(X,Q=this._def){return o.create(this.options.filter((W)=>!X.includes(W)),{...this._def,...Q})}}N0=new WeakMap;o.create=I1;class q0 extends K{constructor(){super(...arguments);S0.set(this,void 0)}_parse(X){let Q=F.getValidEnumValues(this._def.values),W=this._getOrReturnCtx(X);if(W.parsedType!==L.string&&W.parsedType!==L.number){let J=F.objectValues(Q);return V(W,{expected:F.joinValues(J),received:W.parsedType,code:M.invalid_type}),q}if(!x0(this,S0,"f"))C1(this,S0,new Set(F.getValidEnumValues(this._def.values)),"f");if(!x0(this,S0,"f").has(X.data)){let J=F.objectValues(Q);return V(W,{received:W.data,code:M.invalid_enum_value,options:J}),q}return E(X.data)}get enum(){return this._def.values}}S0=new WeakMap;q0.create=(X,Q)=>{return new q0({values:X,typeName:O.ZodNativeEnum,...A(Q)})};class Q0 extends K{unwrap(){return this._def.type}_parse(X){let{ctx:Q}=this._processInputParams(X);if(Q.parsedType!==L.promise&&Q.common.async===!1)return V(Q,{code:M.invalid_type,expected:L.promise,received:Q.parsedType}),q;let W=Q.parsedType===L.promise?Q.data:Promise.resolve(Q.data);return E(W.then((J)=>{return this._def.type.parseAsync(J,{path:Q.path,errorMap:Q.common.contextualErrorMap})}))}}Q0.create=(X,Q)=>{return new Q0({type:X,typeName:O.ZodPromise,...A(Q)})};class I extends K{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===O.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(X){let{status:Q,ctx:W}=this._processInputParams(X),J=this._def.effect||null,G={addIssue:(Y)=>{if(V(W,Y),Y.fatal)Q.abort();else Q.dirty()},get path(){return W.path}};if(G.addIssue=G.addIssue.bind(G),J.type==="preprocess"){let Y=J.transform(W.data,G);if(W.common.async)return Promise.resolve(Y).then(async(H)=>{if(Q.value==="aborted")return q;let B=await this._def.schema._parseAsync({data:H,path:W.path,parent:W});if(B.status==="aborted")return q;if(B.status==="dirty")return Y0(B.value);if(Q.value==="dirty")return Y0(B.value);return B});else{if(Q.value==="aborted")return q;let H=this._def.schema._parseSync({data:Y,path:W.path,parent:W});if(H.status==="aborted")return q;if(H.status==="dirty")return Y0(H.value);if(Q.value==="dirty")return Y0(H.value);return H}}if(J.type==="refinement"){let Y=(H)=>{let B=J.refinement(H,G);if(W.common.async)return Promise.resolve(B);if(B instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return H};if(W.common.async===!1){let H=this._def.schema._parseSync({data:W.data,path:W.path,parent:W});if(H.status==="aborted")return q;if(H.status==="dirty")Q.dirty();return Y(H.value),{status:Q.value,value:H.value}}else return this._def.schema._parseAsync({data:W.data,path:W.path,parent:W}).then((H)=>{if(H.status==="aborted")return q;if(H.status==="dirty")Q.dirty();return Y(H.value).then(()=>{return{status:Q.value,value:H.value}})})}if(J.type==="transform")if(W.common.async===!1){let Y=this._def.schema._parseSync({data:W.data,path:W.path,parent:W});if(!s(Y))return Y;let H=J.transform(Y.value,G);if(H instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:Q.value,value:H}}else return this._def.schema._parseAsync({data:W.data,path:W.path,parent:W}).then((Y)=>{if(!s(Y))return Y;return Promise.resolve(J.transform(Y.value,G)).then((H)=>({status:Q.value,value:H}))});F.assertNever(J)}}I.create=(X,Q,W)=>{return new I({schema:X,typeName:O.ZodEffects,effect:Q,...A(W)})};I.createWithPreprocess=(X,Q,W)=>{return new I({schema:Q,effect:{type:"preprocess",transform:X},typeName:O.ZodEffects,...A(W)})};class T extends K{_parse(X){if(this._getType(X)===L.undefined)return E(void 0);return this._def.innerType._parse(X)}unwrap(){return this._def.innerType}}T.create=(X,Q)=>{return new T({innerType:X,typeName:O.ZodOptional,...A(Q)})};class p extends K{_parse(X){if(this._getType(X)===L.null)return E(null);return this._def.innerType._parse(X)}unwrap(){return this._def.innerType}}p.create=(X,Q)=>{return new p({innerType:X,typeName:O.ZodNullable,...A(Q)})};class A0 extends K{_parse(X){let{ctx:Q}=this._processInputParams(X),W=Q.data;if(Q.parsedType===L.undefined)W=this._def.defaultValue();return this._def.innerType._parse({data:W,path:Q.path,parent:Q})}removeDefault(){return this._def.innerType}}A0.create=(X,Q)=>{return new A0({innerType:X,typeName:O.ZodDefault,defaultValue:typeof Q.default==="function"?Q.default:()=>Q.default,...A(Q)})};class K0 extends K{_parse(X){let{ctx:Q}=this._processInputParams(X),W={...Q,common:{...Q.common,issues:[]}},J=this._def.innerType._parse({data:W.data,path:W.path,parent:{...W}});if(E0(J))return J.then((G)=>{return{status:"valid",value:G.status==="valid"?G.value:this._def.catchValue({get error(){return new v(W.common.issues)},input:W.data})}});else return{status:"valid",value:J.status==="valid"?J.value:this._def.catchValue({get error(){return new v(W.common.issues)},input:W.data})}}removeCatch(){return this._def.innerType}}K0.create=(X,Q)=>{return new K0({innerType:X,typeName:O.ZodCatch,catchValue:typeof Q.catch==="function"?Q.catch:()=>Q.catch,...A(Q)})};class b0 extends K{_parse(X){if(this._getType(X)!==L.nan){let W=this._getOrReturnCtx(X);return V(W,{code:M.invalid_type,expected:L.nan,received:W.parsedType}),q}return{status:"valid",value:X.data}}}b0.create=(X)=>{return new b0({typeName:O.ZodNaN,...A(X)})};var x4=Symbol("zod_brand");class y0 extends K{_parse(X){let{ctx:Q}=this._processInputParams(X),W=Q.data;return this._def.type._parse({data:W,path:Q.path,parent:Q})}unwrap(){return this._def.type}}class I0 extends K{_parse(X){let{status:Q,ctx:W}=this._processInputParams(X);if(W.common.async)return(async()=>{let G=await this._def.in._parseAsync({data:W.data,path:W.path,parent:W});if(G.status==="aborted")return q;if(G.status==="dirty")return Q.dirty(),Y0(G.value);else return this._def.out._parseAsync({data:G.value,path:W.path,parent:W})})();else{let J=this._def.in._parseSync({data:W.data,path:W.path,parent:W});if(J.status==="aborted")return q;if(J.status==="dirty")return Q.dirty(),{status:"dirty",value:J.value};else return this._def.out._parseSync({data:J.value,path:W.path,parent:W})}}static create(X,Q){return new I0({in:X,out:Q,typeName:O.ZodPipeline})}}class j0 extends K{_parse(X){let Q=this._def.innerType._parse(X),W=(J)=>{if(s(J))J.value=Object.freeze(J.value);return J};return E0(Q)?Q.then((J)=>W(J)):W(Q)}unwrap(){return this._def.innerType}}j0.create=(X,Q)=>{return new j0({innerType:X,typeName:O.ZodReadonly,...A(Q)})};function S1(X,Q){let W=typeof X==="function"?X(Q):typeof X==="string"?{message:X}:X;return typeof W==="string"?{message:W}:W}function f1(X,Q={},W){if(X)return e.create().superRefine((J,G)=>{var Y,H;let B=X(J);if(B instanceof Promise)return B.then((z)=>{var w,j;if(!z){let C=S1(Q,J),n=(j=(w=C.fatal)!==null&&w!==void 0?w:W)!==null&&j!==void 0?j:!0;G.addIssue({code:"custom",...C,fatal:n})}});if(!B){let z=S1(Q,J),w=(H=(Y=z.fatal)!==null&&Y!==void 0?Y:W)!==null&&H!==void 0?H:!0;G.addIssue({code:"custom",...z,fatal:w})}return});return e.create()}var h4={object:R.lazycreate},O;(function(X){X.ZodString="ZodString",X.ZodNumber="ZodNumber",X.ZodNaN="ZodNaN",X.ZodBigInt="ZodBigInt",X.ZodBoolean="ZodBoolean",X.ZodDate="ZodDate",X.ZodSymbol="ZodSymbol",X.ZodUndefined="ZodUndefined",X.ZodNull="ZodNull",X.ZodAny="ZodAny",X.ZodUnknown="ZodUnknown",X.ZodNever="ZodNever",X.ZodVoid="ZodVoid",X.ZodArray="ZodArray",X.ZodObject="ZodObject",X.ZodUnion="ZodUnion",X.ZodDiscriminatedUnion="ZodDiscriminatedUnion",X.ZodIntersection="ZodIntersection",X.ZodTuple="ZodTuple",X.ZodRecord="ZodRecord",X.ZodMap="ZodMap",X.ZodSet="ZodSet",X.ZodFunction="ZodFunction",X.ZodLazy="ZodLazy",X.ZodLiteral="ZodLiteral",X.ZodEnum="ZodEnum",X.ZodEffects="ZodEffects",X.ZodNativeEnum="ZodNativeEnum",X.ZodOptional="ZodOptional",X.ZodNullable="ZodNullable",X.ZodDefault="ZodDefault",X.ZodCatch="ZodCatch",X.ZodPromise="ZodPromise",X.ZodBranded="ZodBranded",X.ZodPipeline="ZodPipeline",X.ZodReadonly="ZodReadonly"})(O||(O={}));var y4=(X,Q={message:`Input not instance of ${X.name}`})=>f1((W)=>W instanceof X,Q),P1=f.create,T1=i.create,Z4=b0.create,l4=r.create,g1=M0.create,m4=t.create,c4=_0.create,u4=z0.create,p4=w0.create,n4=e.create,d4=d.create,i4=y.create,r4=C0.create,o4=P.create,a4=R.create,s4=R.strictCreate,t4=V0.create,e4=h0.create,X6=L0.create,Q6=Z.create,W6=v0.create,G6=k0.create,J6=X0.create,$6=H0.create,Y6=U0.create,H6=O0.create,B6=o.create,M6=q0.create,z6=Q0.create,E1=I.create,w6=T.create,V6=p.create,L6=I.createWithPreprocess,U6=I0.create,O6=()=>P1().optional(),q6=()=>T1().optional(),A6=()=>g1().optional(),K6={string:(X)=>f.create({...X,coerce:!0}),number:(X)=>i.create({...X,coerce:!0}),boolean:(X)=>M0.create({...X,coerce:!0}),bigint:(X)=>r.create({...X,coerce:!0}),date:(X)=>t.create({...X,coerce:!0})},j6=q,$=Object.freeze({__proto__:null,defaultErrorMap:B0,setErrorMap:L4,getErrorMap:T0,makeIssue:g0,EMPTY_PATH:U4,addIssueToContext:V,ParseStatus:S,INVALID:q,DIRTY:Y0,OK:E,isAborted:s0,isDirty:t0,isValid:s,isAsync:E0,get util(){return F},get objectUtil(){return a0},ZodParsedType:L,getParsedType:u,ZodType:K,datetimeRegex:b1,ZodString:f,ZodNumber:i,ZodBigInt:r,ZodBoolean:M0,ZodDate:t,ZodSymbol:_0,ZodUndefined:z0,ZodNull:w0,ZodAny:e,ZodUnknown:d,ZodNever:y,ZodVoid:C0,ZodArray:P,ZodObject:R,ZodUnion:V0,ZodDiscriminatedUnion:h0,ZodIntersection:L0,ZodTuple:Z,ZodRecord:v0,ZodMap:k0,ZodSet:X0,ZodFunction:H0,ZodLazy:U0,ZodLiteral:O0,ZodEnum:o,ZodNativeEnum:q0,ZodPromise:Q0,ZodEffects:I,ZodTransformer:I,ZodOptional:T,ZodNullable:p,ZodDefault:A0,ZodCatch:K0,ZodNaN:b0,BRAND:x4,ZodBranded:y0,ZodPipeline:I0,ZodReadonly:j0,custom:f1,Schema:K,ZodSchema:K,late:h4,get ZodFirstPartyTypeKind(){return O},coerce:K6,any:n4,array:o4,bigint:l4,boolean:g1,date:m4,discriminatedUnion:e4,effect:E1,enum:B6,function:$6,instanceof:y4,intersection:X6,lazy:Y6,literal:H6,map:G6,nan:Z4,nativeEnum:M6,never:i4,null:p4,nullable:V6,number:T1,object:a4,oboolean:A6,onumber:q6,optional:w6,ostring:O6,pipeline:U6,preprocess:L6,promise:z6,record:W6,set:J6,strictObject:s4,string:P1,symbol:c4,transformer:E1,tuple:Q6,undefined:u4,union:t4,unknown:d4,void:r4,NEVER:j6,ZodIssueCode:M,quotelessJson:V4,ZodError:v});var X1="2024-11-05",x1=[X1,"2024-10-07"],Z0="2.0",h1=$.union([$.string(),$.number().int()]),y1=$.string(),x=$.object({_meta:$.optional($.object({progressToken:$.optional(h1)}).passthrough())}).passthrough(),k=$.object({method:$.string(),params:$.optional(x)}),f0=$.object({_meta:$.optional($.object({}).passthrough())}).passthrough(),l=$.object({method:$.string(),params:$.optional(f0)}),h=$.object({_meta:$.optional($.object({}).passthrough())}).passthrough(),l0=$.union([$.string(),$.number().int()]),F6=$.object({jsonrpc:$.literal(Z0),id:l0}).merge(k).strict(),R6=$.object({jsonrpc:$.literal(Z0)}).merge(l).strict(),D6=$.object({jsonrpc:$.literal(Z0),id:l0,result:h}).strict(),W0;(function(X){X[X.ConnectionClosed=-32000]="ConnectionClosed",X[X.RequestTimeout=-32001]="RequestTimeout",X[X.ParseError=-32700]="ParseError",X[X.InvalidRequest=-32600]="InvalidRequest",X[X.MethodNotFound=-32601]="MethodNotFound",X[X.InvalidParams=-32602]="InvalidParams",X[X.InternalError=-32603]="InternalError"})(W0||(W0={}));var N6=$.object({jsonrpc:$.literal(Z0),id:l0,error:$.object({code:$.number().int(),message:$.string(),data:$.optional($.unknown())})}).strict(),Z1=$.union([F6,R6,D6,N6]),m0=h.strict(),c0=l.extend({method:$.literal("notifications/cancelled"),params:f0.extend({requestId:l0,reason:$.string().optional()})}),l1=$.object({name:$.string(),version:$.string()}).passthrough(),S6=$.object({experimental:$.optional($.object({}).passthrough()),sampling:$.optional($.object({}).passthrough()),roots:$.optional($.object({listChanged:$.optional($.boolean())}).passthrough())}).passthrough(),Q1=k.extend({method:$.literal("initialize"),params:x.extend({protocolVersion:$.string(),capabilities:S6,clientInfo:l1})}),E6=$.object({experimental:$.optional($.object({}).passthrough()),logging:$.optional($.object({}).passthrough()),prompts:$.optional($.object({listChanged:$.optional($.boolean())}).passthrough()),resources:$.optional($.object({subscribe:$.optional($.boolean()),listChanged:$.optional($.boolean())}).passthrough()),tools:$.optional($.object({listChanged:$.optional($.boolean())}).passthrough())}).passthrough(),_6=h.extend({protocolVersion:$.string(),capabilities:E6,serverInfo:l1,instructions:$.optional($.string())}),W1=l.extend({method:$.literal("notifications/initialized")}),u0=k.extend({method:$.literal("ping")}),C6=$.object({progress:$.number(),total:$.optional($.number())}).passthrough(),p0=l.extend({method:$.literal("notifications/progress"),params:f0.merge(C6).extend({progressToken:h1})}),n0=k.extend({params:x.extend({cursor:$.optional(y1)}).optional()}),d0=h.extend({nextCursor:$.optional(y1)}),m1=$.object({uri:$.string(),mimeType:$.optional($.string())}).passthrough(),c1=m1.extend({text:$.string()}),u1=m1.extend({blob:$.string().base64()}),v6=$.object({uri:$.string(),name:$.string(),description:$.optional($.string()),mimeType:$.optional($.string())}).passthrough(),k6=$.object({uriTemplate:$.string(),name:$.string(),description:$.optional($.string()),mimeType:$.optional($.string())}).passthrough(),b6=n0.extend({method:$.literal("resources/list")}),I6=d0.extend({resources:$.array(v6)}),f6=n0.extend({method:$.literal("resources/templates/list")}),P6=d0.extend({resourceTemplates:$.array(k6)}),T6=k.extend({method:$.literal("resources/read"),params:x.extend({uri:$.string()})}),g6=h.extend({contents:$.array($.union([c1,u1]))}),x6=l.extend({method:$.literal("notifications/resources/list_changed")}),h6=k.extend({method:$.literal("resources/subscribe"),params:x.extend({uri:$.string()})}),y6=k.extend({method:$.literal("resources/unsubscribe"),params:x.extend({uri:$.string()})}),Z6=l.extend({method:$.literal("notifications/resources/updated"),params:f0.extend({uri:$.string()})}),l6=$.object({name:$.string(),description:$.optional($.string()),required:$.optional($.boolean())}).passthrough(),m6=$.object({name:$.string(),description:$.optional($.string()),arguments:$.optional($.array(l6))}).passthrough(),c6=n0.extend({method:$.literal("prompts/list")}),u6=d0.extend({prompts:$.array(m6)}),p6=k.extend({method:$.literal("prompts/get"),params:x.extend({name:$.string(),arguments:$.optional($.record($.string()))})}),i0=$.object({type:$.literal("text"),text:$.string()}).passthrough(),r0=$.object({type:$.literal("image"),data:$.string().base64(),mimeType:$.string()}).passthrough(),p1=$.object({type:$.literal("resource"),resource:$.union([c1,u1])}).passthrough(),n6=$.object({role:$.enum(["user","assistant"]),content:$.union([i0,r0,p1])}).passthrough(),d6=h.extend({description:$.optional($.string()),messages:$.array(n6)}),i6=l.extend({method:$.literal("notifications/prompts/list_changed")}),r6=$.object({name:$.string(),description:$.optional($.string()),inputSchema:$.object({type:$.literal("object"),properties:$.optional($.object({}).passthrough())}).passthrough()}).passthrough(),G1=n0.extend({method:$.literal("tools/list")}),o6=d0.extend({tools:$.array(r6)}),n1=h.extend({content:$.array($.union([i0,r0,p1])),isError:$.boolean().default(!1).optional()}),u8=n1.or(h.extend({toolResult:$.unknown()})),J1=k.extend({method:$.literal("tools/call"),params:x.extend({name:$.string(),arguments:$.optional($.record($.unknown()))})}),a6=l.extend({method:$.literal("notifications/tools/list_changed")}),d1=$.enum(["debug","info","notice","warning","error","critical","alert","emergency"]),s6=k.extend({method:$.literal("logging/setLevel"),params:x.extend({level:d1})}),t6=l.extend({method:$.literal("notifications/message"),params:f0.extend({level:d1,logger:$.optional($.string()),data:$.unknown()})}),e6=$.object({name:$.string().optional()}).passthrough(),X8=$.object({hints:$.optional($.array(e6)),costPriority:$.optional($.number().min(0).max(1)),speedPriority:$.optional($.number().min(0).max(1)),intelligencePriority:$.optional($.number().min(0).max(1))}).passthrough(),Q8=$.object({role:$.enum(["user","assistant"]),content:$.union([i0,r0])}).passthrough(),W8=k.extend({method:$.literal("sampling/createMessage"),params:x.extend({messages:$.array(Q8),systemPrompt:$.optional($.string()),includeContext:$.optional($.enum(["none","thisServer","allServers"])),temperature:$.optional($.number()),maxTokens:$.number().int(),stopSequences:$.optional($.array($.string())),metadata:$.optional($.object({}).passthrough()),modelPreferences:$.optional(X8)})}),$1=h.extend({model:$.string(),stopReason:$.optional($.enum(["endTurn","stopSequence","maxTokens"]).or($.string())),role:$.enum(["user","assistant"]),content:$.discriminatedUnion("type",[i0,r0])}),G8=$.object({type:$.literal("ref/resource"),uri:$.string()}).passthrough(),J8=$.object({type:$.literal("ref/prompt"),name:$.string()}).passthrough(),$8=k.extend({method:$.literal("completion/complete"),params:x.extend({ref:$.union([J8,G8]),argument:$.object({name:$.string(),value:$.string()}).passthrough()})}),Y8=h.extend({completion:$.object({values:$.array($.string()).max(100),total:$.optional($.number().int()),hasMore:$.optional($.boolean())}).passthrough()}),H8=$.object({uri:$.string().startsWith("file://"),name:$.optional($.string())}).passthrough(),B8=k.extend({method:$.literal("roots/list")}),Y1=h.extend({roots:$.array(H8)}),M8=l.extend({method:$.literal("notifications/roots/list_changed")}),p8=$.union([u0,Q1,$8,s6,p6,c6,b6,f6,T6,h6,y6,J1,G1]),n8=$.union([c0,p0,W1,M8]),d8=$.union([m0,$1,Y1]),i8=$.union([u0,W8,B8]),r8=$.union([c0,p0,t6,Z6,x6,a6,i6]),o8=$.union([m0,_6,Y8,d6,u6,I6,P6,g6,n1,o6]);class P0 extends Error{constructor(X,Q,W){super(`MCP error ${X}: ${Q}`);this.code=X,this.data=W}}var z8=60000;class H1{constructor(X){this._options=X,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this.setNotificationHandler(c0,(Q)=>{let W=this._requestHandlerAbortControllers.get(Q.params.requestId);W===null||W===void 0||W.abort(Q.params.reason)}),this.setNotificationHandler(p0,(Q)=>{this._onprogress(Q)}),this.setRequestHandler(u0,(Q)=>({}))}async connect(X){this._transport=X,this._transport.onclose=()=>{this._onclose()},this._transport.onerror=(Q)=>{this._onerror(Q)},this._transport.onmessage=(Q)=>{if(!("method"in Q))this._onresponse(Q);else if("id"in Q)this._onrequest(Q);else this._onnotification(Q)},await this._transport.start()}_onclose(){var X;let Q=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._transport=void 0,(X=this.onclose)===null||X===void 0||X.call(this);let W=new P0(W0.ConnectionClosed,"Connection closed");for(let J of Q.values())J(W)}_onerror(X){var Q;(Q=this.onerror)===null||Q===void 0||Q.call(this,X)}_onnotification(X){var Q;let W=(Q=this._notificationHandlers.get(X.method))!==null&&Q!==void 0?Q:this.fallbackNotificationHandler;if(W===void 0)return;Promise.resolve().then(()=>W(X)).catch((J)=>this._onerror(new Error(`Uncaught error in notification handler: ${J}`)))}_onrequest(X){var Q,W;let J=(Q=this._requestHandlers.get(X.method))!==null&&Q!==void 0?Q:this.fallbackRequestHandler;if(J===void 0){(W=this._transport)===null||W===void 0||W.send({jsonrpc:"2.0",id:X.id,error:{code:W0.MethodNotFound,message:"Method not found"}}).catch((Y)=>this._onerror(new Error(`Failed to send an error response: ${Y}`)));return}let G=new AbortController;this._requestHandlerAbortControllers.set(X.id,G),Promise.resolve().then(()=>J(X,{signal:G.signal})).then((Y)=>{var H;if(G.signal.aborted)return;return(H=this._transport)===null||H===void 0?void 0:H.send({result:Y,jsonrpc:"2.0",id:X.id})},(Y)=>{var H,B;if(G.signal.aborted)return;return(H=this._transport)===null||H===void 0?void 0:H.send({jsonrpc:"2.0",id:X.id,error:{code:Number.isSafeInteger(Y.code)?Y.code:W0.InternalError,message:(B=Y.message)!==null&&B!==void 0?B:"Internal error"}})}).catch((Y)=>this._onerror(new Error(`Failed to send response: ${Y}`))).finally(()=>{this._requestHandlerAbortControllers.delete(X.id)})}_onprogress(X){let{progressToken:Q,...W}=X.params,J=this._progressHandlers.get(Number(Q));if(J===void 0){this._onerror(new Error(`Received a progress notification for an unknown token: ${JSON.stringify(X)}`));return}J(W)}_onresponse(X){let Q=X.id,W=this._responseHandlers.get(Number(Q));if(W===void 0){this._onerror(new Error(`Received a response for an unknown message ID: ${JSON.stringify(X)}`));return}if(this._responseHandlers.delete(Number(Q)),this._progressHandlers.delete(Number(Q)),"result"in X)W(X);else{let J=new P0(X.error.code,X.error.message,X.error.data);W(J)}}get transport(){return this._transport}async close(){var X;await((X=this._transport)===null||X===void 0?void 0:X.close())}request(X,Q,W){return new Promise((J,G)=>{var Y,H,B,z;if(!this._transport){G(new Error("Not connected"));return}if(((Y=this._options)===null||Y===void 0?void 0:Y.enforceStrictCapabilities)===!0)this.assertCapabilityForMethod(X.method);(H=W===null||W===void 0?void 0:W.signal)===null||H===void 0||H.throwIfAborted();let w=this._requestMessageId++,j={...X,jsonrpc:"2.0",id:w};if(W===null||W===void 0?void 0:W.onprogress)this._progressHandlers.set(w,W.onprogress),j.params={...X.params,_meta:{progressToken:w}};let C=void 0;this._responseHandlers.set(w,(b)=>{var a;if(C!==void 0)clearTimeout(C);if((a=W===null||W===void 0?void 0:W.signal)===null||a===void 0?void 0:a.aborted)return;if(b instanceof Error)return G(b);try{let D0=Q.parse(b.result);J(D0)}catch(D0){G(D0)}});let n=(b)=>{var a;this._responseHandlers.delete(w),this._progressHandlers.delete(w),(a=this._transport)===null||a===void 0||a.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:w,reason:String(b)}}).catch((D0)=>this._onerror(new Error(`Failed to send cancellation: ${D0}`))),G(b)};(B=W===null||W===void 0?void 0:W.signal)===null||B===void 0||B.addEventListener("abort",()=>{var b;if(C!==void 0)clearTimeout(C);n((b=W===null||W===void 0?void 0:W.signal)===null||b===void 0?void 0:b.reason)});let D1=(z=W===null||W===void 0?void 0:W.timeout)!==null&&z!==void 0?z:z8;C=setTimeout(()=>n(new P0(W0.RequestTimeout,"Request timed out",{timeout:D1})),D1),this._transport.send(j).catch((b)=>{if(C!==void 0)clearTimeout(C);G(b)})})}async notification(X){if(!this._transport)throw new Error("Not connected");this.assertNotificationCapability(X.method);let Q={...X,jsonrpc:"2.0"};await this._transport.send(Q)}setRequestHandler(X,Q){let W=X.shape.method.value;this.assertRequestHandlerCapability(W),this._requestHandlers.set(W,(J,G)=>Promise.resolve(Q(X.parse(J),G)))}removeRequestHandler(X){this._requestHandlers.delete(X)}assertCanSetRequestHandler(X){if(this._requestHandlers.has(X))throw new Error(`A request handler for ${X} already exists, which would be overridden`)}setNotificationHandler(X,Q){this._notificationHandlers.set(X.shape.method.value,(W)=>Promise.resolve(Q(X.parse(W))))}removeNotificationHandler(X){this._notificationHandlers.delete(X)}}function i1(X,Q){return Object.entries(Q).reduce((W,[J,G])=>{if(G&&typeof G==="object")W[J]=W[J]?{...W[J],...G}:G;else W[J]=G;return W},{...X})}class B1 extends H1{constructor(X,Q){var W;super(Q);this._serverInfo=X,this._capabilities=(W=Q===null||Q===void 0?void 0:Q.capabilities)!==null&&W!==void 0?W:{},this._instructions=Q===null||Q===void 0?void 0:Q.instructions,this.setRequestHandler(Q1,(J)=>this._oninitialize(J)),this.setNotificationHandler(W1,()=>{var J;return(J=this.oninitialized)===null||J===void 0?void 0:J.call(this)})}registerCapabilities(X){if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");this._capabilities=i1(this._capabilities,X)}assertCapabilityForMethod(X){var Q,W;switch(X){case"sampling/createMessage":if(!((Q=this._clientCapabilities)===null||Q===void 0?void 0:Q.sampling))throw new Error(`Client does not support sampling (required for ${X})`);break;case"roots/list":if(!((W=this._clientCapabilities)===null||W===void 0?void 0:W.roots))throw new Error(`Client does not support listing roots (required for ${X})`);break;case"ping":break}}assertNotificationCapability(X){switch(X){case"notifications/message":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${X})`);break;case"notifications/resources/updated":case"notifications/resources/list_changed":if(!this._capabilities.resources)throw new Error(`Server does not support notifying about resources (required for ${X})`);break;case"notifications/tools/list_changed":if(!this._capabilities.tools)throw new Error(`Server does not support notifying of tool list changes (required for ${X})`);break;case"notifications/prompts/list_changed":if(!this._capabilities.prompts)throw new Error(`Server does not support notifying of prompt list changes (required for ${X})`);break;case"notifications/cancelled":break;case"notifications/progress":break}}assertRequestHandlerCapability(X){switch(X){case"sampling/createMessage":if(!this._capabilities.sampling)throw new Error(`Server does not support sampling (required for ${X})`);break;case"logging/setLevel":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${X})`);break;case"prompts/get":case"prompts/list":if(!this._capabilities.prompts)throw new Error(`Server does not support prompts (required for ${X})`);break;case"resources/list":case"resources/templates/list":case"resources/read":if(!this._capabilities.resources)throw new Error(`Server does not support resources (required for ${X})`);break;case"tools/call":case"tools/list":if(!this._capabilities.tools)throw new Error(`Server does not support tools (required for ${X})`);break;case"ping":case"initialize":break}}async _oninitialize(X){let Q=X.params.protocolVersion;return this._clientCapabilities=X.params.capabilities,this._clientVersion=X.params.clientInfo,{protocolVersion:x1.includes(Q)?Q:X1,capabilities:this.getCapabilities(),serverInfo:this._serverInfo,...this._instructions&&{instructions:this._instructions}}}getClientCapabilities(){return this._clientCapabilities}getClientVersion(){return this._clientVersion}getCapabilities(){return this._capabilities}async ping(){return this.request({method:"ping"},m0)}async createMessage(X,Q){return this.request({method:"sampling/createMessage",params:X},$1,Q)}async listRoots(X,Q){return this.request({method:"roots/list",params:X},Y1,Q)}async sendLoggingMessage(X){return this.notification({method:"notifications/message",params:X})}async sendResourceUpdated(X){return this.notification({method:"notifications/resources/updated",params:X})}async sendResourceListChanged(){return this.notification({method:"notifications/resources/list_changed"})}async sendToolListChanged(){return this.notification({method:"notifications/tools/list_changed"})}async sendPromptListChanged(){return this.notification({method:"notifications/prompts/list_changed"})}}import o1 from"process";class M1{append(X){this._buffer=this._buffer?Buffer.concat([this._buffer,X]):X}readMessage(){if(!this._buffer)return null;let X=this._buffer.indexOf(`
`);if(X===-1)return null;let Q=this._buffer.toString("utf8",0,X);return this._buffer=this._buffer.subarray(X+1),w8(Q)}clear(){this._buffer=void 0}}function w8(X){return Z1.parse(JSON.parse(X))}function r1(X){return JSON.stringify(X)+`
`}class z1{constructor(X=o1.stdin,Q=o1.stdout){this._stdin=X,this._stdout=Q,this._readBuffer=new M1,this._started=!1,this._ondata=(W)=>{this._readBuffer.append(W),this.processReadBuffer()},this._onerror=(W)=>{var J;(J=this.onerror)===null||J===void 0||J.call(this,W)}}async start(){if(this._started)throw new Error("StdioServerTransport already started! If using Server class, note that connect() calls start() automatically.");this._started=!0,this._stdin.on("data",this._ondata),this._stdin.on("error",this._onerror)}processReadBuffer(){var X,Q;while(!0)try{let W=this._readBuffer.readMessage();if(W===null)break;(X=this.onmessage)===null||X===void 0||X.call(this,W)}catch(W){(Q=this.onerror)===null||Q===void 0||Q.call(this,W)}}async close(){var X;if(this._stdin.off("data",this._ondata),this._stdin.off("error",this._onerror),this._stdin.listenerCount("data")===0)this._stdin.pause();this._readBuffer.clear(),(X=this.onclose)===null||X===void 0||X.call(this)}send(X){return new Promise((Q)=>{let W=r1(X);if(this._stdout.write(W))Q();else this._stdout.once("drain",Q)})}}import b8,{promises as Y4}from"fs";import{resolve as H4}from"path";var N=typeof globalThis!=="undefined"&&globalThis||typeof self!=="undefined"&&self||typeof global!=="undefined"&&global||{},_={searchParams:"URLSearchParams"in N,iterable:"Symbol"in N&&"iterator"in Symbol,blob:"FileReader"in N&&"Blob"in N&&function(){try{return new Blob,!0}catch(X){return!1}}(),formData:"FormData"in N,arrayBuffer:"ArrayBuffer"in N};function V8(X){return X&&DataView.prototype.isPrototypeOf(X)}if(_.arrayBuffer)a1=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],t1=ArrayBuffer.isView||function(X){return X&&a1.indexOf(Object.prototype.toString.call(X))>-1};var a1,t1;function F0(X){if(typeof X!=="string")X=String(X);if(/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(X)||X==="")throw new TypeError('Invalid character in header field name: "'+X+'"');return X.toLowerCase()}function V1(X){if(typeof X!=="string")X=String(X);return X}function L1(X){var Q={next:function(){var W=X.shift();return{done:W===void 0,value:W}}};if(_.iterable)Q[Symbol.iterator]=function(){return Q};return Q}function D(X){if(this.map={},X instanceof D)X.forEach(function(Q,W){this.append(W,Q)},this);else if(Array.isArray(X))X.forEach(function(Q){if(Q.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+Q.length);this.append(Q[0],Q[1])},this);else if(X)Object.getOwnPropertyNames(X).forEach(function(Q){this.append(Q,X[Q])},this)}D.prototype.append=function(X,Q){X=F0(X),Q=V1(Q);var W=this.map[X];this.map[X]=W?W+", "+Q:Q};D.prototype.delete=function(X){delete this.map[F0(X)]};D.prototype.get=function(X){return X=F0(X),this.has(X)?this.map[X]:null};D.prototype.has=function(X){return this.map.hasOwnProperty(F0(X))};D.prototype.set=function(X,Q){this.map[F0(X)]=V1(Q)};D.prototype.forEach=function(X,Q){for(var W in this.map)if(this.map.hasOwnProperty(W))X.call(Q,this.map[W],W,this)};D.prototype.keys=function(){var X=[];return this.forEach(function(Q,W){X.push(W)}),L1(X)};D.prototype.values=function(){var X=[];return this.forEach(function(Q){X.push(Q)}),L1(X)};D.prototype.entries=function(){var X=[];return this.forEach(function(Q,W){X.push([W,Q])}),L1(X)};if(_.iterable)D.prototype[Symbol.iterator]=D.prototype.entries;function w1(X){if(X._noBody)return;if(X.bodyUsed)return Promise.reject(new TypeError("Already read"));X.bodyUsed=!0}function e1(X){return new Promise(function(Q,W){X.onload=function(){Q(X.result)},X.onerror=function(){W(X.error)}})}function L8(X){var Q=new FileReader,W=e1(Q);return Q.readAsArrayBuffer(X),W}function U8(X){var Q=new FileReader,W=e1(Q),J=/charset=([A-Za-z0-9_-]+)/.exec(X.type),G=J?J[1]:"utf-8";return Q.readAsText(X,G),W}function O8(X){var Q=new Uint8Array(X),W=new Array(Q.length);for(var J=0;J<Q.length;J++)W[J]=String.fromCharCode(Q[J]);return W.join("")}function s1(X){if(X.slice)return X.slice(0);else{var Q=new Uint8Array(X.byteLength);return Q.set(new Uint8Array(X)),Q.buffer}}function X4(){if(this.bodyUsed=!1,this._initBody=function(X){if(this.bodyUsed=this.bodyUsed,this._bodyInit=X,!X)this._noBody=!0,this._bodyText="";else if(typeof X==="string")this._bodyText=X;else if(_.blob&&Blob.prototype.isPrototypeOf(X))this._bodyBlob=X;else if(_.formData&&FormData.prototype.isPrototypeOf(X))this._bodyFormData=X;else if(_.searchParams&&URLSearchParams.prototype.isPrototypeOf(X))this._bodyText=X.toString();else if(_.arrayBuffer&&_.blob&&V8(X))this._bodyArrayBuffer=s1(X.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else if(_.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(X)||t1(X)))this._bodyArrayBuffer=s1(X);else this._bodyText=X=Object.prototype.toString.call(X);if(!this.headers.get("content-type")){if(typeof X==="string")this.headers.set("content-type","text/plain;charset=UTF-8");else if(this._bodyBlob&&this._bodyBlob.type)this.headers.set("content-type",this._bodyBlob.type);else if(_.searchParams&&URLSearchParams.prototype.isPrototypeOf(X))this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8")}},_.blob)this.blob=function(){var X=w1(this);if(X)return X;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);else if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));else if(this._bodyFormData)throw new Error("could not read FormData body as blob");else return Promise.resolve(new Blob([this._bodyText]))};if(this.arrayBuffer=function(){if(this._bodyArrayBuffer){var X=w1(this);if(X)return X;else if(ArrayBuffer.isView(this._bodyArrayBuffer))return Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength));else return Promise.resolve(this._bodyArrayBuffer)}else if(_.blob)return this.blob().then(L8);else throw new Error("could not read as ArrayBuffer")},this.text=function(){var X=w1(this);if(X)return X;if(this._bodyBlob)return U8(this._bodyBlob);else if(this._bodyArrayBuffer)return Promise.resolve(O8(this._bodyArrayBuffer));else if(this._bodyFormData)throw new Error("could not read FormData body as text");else return Promise.resolve(this._bodyText)},_.formData)this.formData=function(){return this.text().then(K8)};return this.json=function(){return this.text().then(JSON.parse)},this}var q8=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function A8(X){var Q=X.toUpperCase();return q8.indexOf(Q)>-1?Q:X}function J0(X,Q){if(!(this instanceof J0))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');Q=Q||{};var W=Q.body;if(X instanceof J0){if(X.bodyUsed)throw new TypeError("Already read");if(this.url=X.url,this.credentials=X.credentials,!Q.headers)this.headers=new D(X.headers);if(this.method=X.method,this.mode=X.mode,this.signal=X.signal,!W&&X._bodyInit!=null)W=X._bodyInit,X.bodyUsed=!0}else this.url=String(X);if(this.credentials=Q.credentials||this.credentials||"same-origin",Q.headers||!this.headers)this.headers=new D(Q.headers);if(this.method=A8(Q.method||this.method||"GET"),this.mode=Q.mode||this.mode||null,this.signal=Q.signal||this.signal||function(){if("AbortController"in N){var Y=new AbortController;return Y.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&W)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(W),this.method==="GET"||this.method==="HEAD"){if(Q.cache==="no-store"||Q.cache==="no-cache"){var J=/([?&])_=[^&]*/;if(J.test(this.url))this.url=this.url.replace(J,"$1_="+new Date().getTime());else{var G=/\?/;this.url+=(G.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}}J0.prototype.clone=function(){return new J0(this,{body:this._bodyInit})};function K8(X){var Q=new FormData;return X.trim().split("&").forEach(function(W){if(W){var J=W.split("="),G=J.shift().replace(/\+/g," "),Y=J.join("=").replace(/\+/g," ");Q.append(decodeURIComponent(G),decodeURIComponent(Y))}}),Q}function j8(X){var Q=new D,W=X.replace(/\r?\n[\t ]+/g," ");return W.split("\r").map(function(J){return J.indexOf(`
`)===0?J.substr(1,J.length):J}).forEach(function(J){var G=J.split(":"),Y=G.shift().trim();if(Y){var H=G.join(":").trim();try{Q.append(Y,H)}catch(B){console.warn("Response "+B.message)}}}),Q}X4.call(J0.prototype);function m(X,Q){if(!(this instanceof m))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(!Q)Q={};if(this.type="default",this.status=Q.status===void 0?200:Q.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=Q.statusText===void 0?"":""+Q.statusText,this.headers=new D(Q.headers),this.url=Q.url||"",this._initBody(X)}X4.call(m.prototype);m.prototype.clone=function(){return new m(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new D(this.headers),url:this.url})};m.error=function(){var X=new m(null,{status:200,statusText:""});return X.ok=!1,X.status=0,X.type="error",X};var F8=[301,302,303,307,308];m.redirect=function(X,Q){if(F8.indexOf(Q)===-1)throw new RangeError("Invalid status code");return new m(null,{status:Q,headers:{location:X}})};var G0=N.DOMException;try{new G0}catch(X){G0=function(Q,W){this.message=Q,this.name=W;var J=Error(Q);this.stack=J.stack},G0.prototype=Object.create(Error.prototype),G0.prototype.constructor=G0}function Q4(X,Q){return new Promise(function(W,J){var G=new J0(X,Q);if(G.signal&&G.signal.aborted)return J(new G0("Aborted","AbortError"));var Y=new XMLHttpRequest;function H(){Y.abort()}Y.onload=function(){var w={statusText:Y.statusText,headers:j8(Y.getAllResponseHeaders()||"")};if(G.url.indexOf("file://")===0&&(Y.status<200||Y.status>599))w.status=200;else w.status=Y.status;w.url="responseURL"in Y?Y.responseURL:w.headers.get("X-Request-URL");var j="response"in Y?Y.response:Y.responseText;setTimeout(function(){W(new m(j,w))},0)},Y.onerror=function(){setTimeout(function(){J(new TypeError("Network request failed"))},0)},Y.ontimeout=function(){setTimeout(function(){J(new TypeError("Network request timed out"))},0)},Y.onabort=function(){setTimeout(function(){J(new G0("Aborted","AbortError"))},0)};function B(w){try{return w===""&&N.location.href?N.location.href:w}catch(j){return w}}if(Y.open(G.method,B(G.url),!0),G.credentials==="include")Y.withCredentials=!0;else if(G.credentials==="omit")Y.withCredentials=!1;if("responseType"in Y){if(_.blob)Y.responseType="blob";else if(_.arrayBuffer)Y.responseType="arraybuffer"}if(Q&&typeof Q.headers==="object"&&!(Q.headers instanceof D||N.Headers&&Q.headers instanceof N.Headers)){var z=[];Object.getOwnPropertyNames(Q.headers).forEach(function(w){z.push(F0(w)),Y.setRequestHeader(w,V1(Q.headers[w]))}),G.headers.forEach(function(w,j){if(z.indexOf(j)===-1)Y.setRequestHeader(j,w)})}else G.headers.forEach(function(w,j){Y.setRequestHeader(j,w)});if(G.signal)G.signal.addEventListener("abort",H),Y.onreadystatechange=function(){if(Y.readyState===4)G.signal.removeEventListener("abort",H)};Y.send(typeof G._bodyInit==="undefined"?null:G._bodyInit)})}Q4.polyfill=!0;if(!N.fetch)N.fetch=Q4,N.Headers=D,N.Request=J0,N.Response=m;var R8="0.5.13",G4="11434",J4=`http://127.0.0.1:${G4}`,D8=Object.defineProperty,N8=(X,Q,W)=>(Q in X)?D8(X,Q,{enumerable:!0,configurable:!0,writable:!0,value:W}):X[Q]=W,U1=(X,Q,W)=>{return N8(X,typeof Q!=="symbol"?Q+"":Q,W),W};class q1 extends Error{constructor(X,Q){super(X);if(this.error=X,this.status_code=Q,this.name="ResponseError",Error.captureStackTrace)Error.captureStackTrace(this,q1)}}class $4{constructor(X,Q,W){U1(this,"abortController"),U1(this,"itr"),U1(this,"doneCallback"),this.abortController=X,this.itr=Q,this.doneCallback=W}abort(){this.abortController.abort()}async*[Symbol.asyncIterator](){for await(let X of this.itr){if("error"in X)throw new Error(X.error);if(yield X,X.done||X.status==="success"){this.doneCallback();return}}throw new Error("Did not receive done or success response in stream.")}}var A1=async(X)=>{if(X.ok)return;let Q=`Error ${X.status}: ${X.statusText}`,W=null;if(X.headers.get("content-type")?.includes("application/json"))try{W=await X.json(),Q=W.error||Q}catch(J){console.log("Failed to parse error response as JSON")}else try{console.log("Getting text from response"),Q=await X.text()||Q}catch(J){console.log("Failed to get text from error response")}throw new q1(Q,X.status)};function S8(){if(typeof window!=="undefined"&&window.navigator)return`${window.navigator.platform.toLowerCase()} Browser/${navigator.userAgent};`;else if(typeof process!=="undefined")return`${process.arch} ${process.platform} Node.js/${process.version}`;return""}var K1=async(X,Q,W={})=>{let J={"Content-Type":"application/json",Accept:"application/json","User-Agent":`ollama-js/${R8} (${S8()})`};if(!W.headers)W.headers={};let G=Object.fromEntries(Object.entries(W.headers).filter(([Y])=>!Object.keys(J).some((H)=>H.toLowerCase()===Y.toLowerCase())));return W.headers={...J,...G},X(Q,W)},W4=async(X,Q,W)=>{let J=await K1(X,Q,{headers:W?.headers});return await A1(J),J},R0=async(X,Q,W,J)=>{let Y=((B)=>{return B!==null&&typeof B==="object"&&!Array.isArray(B)})(W)?JSON.stringify(W):W,H=await K1(X,Q,{method:"POST",body:Y,signal:J?.signal,headers:J?.headers});return await A1(H),H},E8=async(X,Q,W,J)=>{let G=await K1(X,Q,{method:"DELETE",body:JSON.stringify(W),headers:J?.headers});return await A1(G),G},_8=async function*(X){let Q=new TextDecoder("utf-8"),W="",J=X.getReader();while(!0){let{done:G,value:Y}=await J.read();if(G)break;W+=Q.decode(Y);let H=W.split(`
`);W=H.pop()??"";for(let B of H)try{yield JSON.parse(B)}catch(z){console.warn("invalid json: ",B)}}for(let G of W.split(`
`).filter((Y)=>Y!==""))try{yield JSON.parse(G)}catch(Y){console.warn("invalid json: ",G)}},C8=(X)=>{if(!X)return J4;let Q=X.includes("://");if(X.startsWith(":"))X=`http://127.0.0.1${X}`,Q=!0;if(!Q)X=`http://${X}`;let W=new URL(X),J=W.port;if(!J)if(!Q)J=G4;else J=W.protocol==="https:"?"443":"80";let G=`${W.protocol}//${W.hostname}:${J}${W.pathname}`;if(G.endsWith("/"))G=G.slice(0,-1);return G},v8=Object.defineProperty,k8=(X,Q,W)=>(Q in X)?v8(X,Q,{enumerable:!0,configurable:!0,writable:!0,value:W}):X[Q]=W,O1=(X,Q,W)=>{return k8(X,typeof Q!=="symbol"?Q+"":Q,W),W},j1=class X{constructor(Q){if(O1(this,"config"),O1(this,"fetch"),O1(this,"ongoingStreamedRequests",[]),this.config={host:"",headers:Q?.headers},!Q?.proxy)this.config.host=C8(Q?.host??J4);this.fetch=Q?.fetch??fetch}abort(){for(let Q of this.ongoingStreamedRequests)Q.abort();this.ongoingStreamedRequests.length=0}async processStreamableRequest(Q,W){W.stream=W.stream??!1;let J=`${this.config.host}/api/${Q}`;if(W.stream){let Y=new AbortController,H=await R0(this.fetch,J,W,{signal:Y.signal,headers:this.config.headers});if(!H.body)throw new Error("Missing body");let B=_8(H.body),z=new $4(Y,B,()=>{let w=this.ongoingStreamedRequests.indexOf(z);if(w>-1)this.ongoingStreamedRequests.splice(w,1)});return this.ongoingStreamedRequests.push(z),z}return await(await R0(this.fetch,J,W,{headers:this.config.headers})).json()}async encodeImage(Q){if(typeof Q!=="string"){let W=new Uint8Array(Q),J="",G=W.byteLength;for(let Y=0;Y<G;Y++)J+=String.fromCharCode(W[Y]);return btoa(J)}return Q}async generate(Q){if(Q.images)Q.images=await Promise.all(Q.images.map(this.encodeImage.bind(this)));return this.processStreamableRequest("generate",Q)}async chat(Q){if(Q.messages){for(let W of Q.messages)if(W.images)W.images=await Promise.all(W.images.map(this.encodeImage.bind(this)))}return this.processStreamableRequest("chat",Q)}async create(Q){return this.processStreamableRequest("create",{...Q})}async pull(Q){return this.processStreamableRequest("pull",{name:Q.model,stream:Q.stream,insecure:Q.insecure})}async push(Q){return this.processStreamableRequest("push",{name:Q.model,stream:Q.stream,insecure:Q.insecure})}async delete(Q){return await E8(this.fetch,`${this.config.host}/api/delete`,{name:Q.model},{headers:this.config.headers}),{status:"success"}}async copy(Q){return await R0(this.fetch,`${this.config.host}/api/copy`,{...Q},{headers:this.config.headers}),{status:"success"}}async list(){return await(await W4(this.fetch,`${this.config.host}/api/tags`,{headers:this.config.headers})).json()}async show(Q){return await(await R0(this.fetch,`${this.config.host}/api/show`,{...Q},{headers:this.config.headers})).json()}async embed(Q){return await(await R0(this.fetch,`${this.config.host}/api/embed`,{...Q},{headers:this.config.headers})).json()}async embeddings(Q){return await(await R0(this.fetch,`${this.config.host}/api/embeddings`,{...Q},{headers:this.config.headers})).json()}async ps(){return await(await W4(this.fetch,`${this.config.host}/api/ps`,{headers:this.config.headers})).json()}},MX=new j1;class B4 extends j1{async encodeImage(X){if(typeof X!=="string")return Buffer.from(X).toString("base64");try{if(b8.existsSync(X)){let Q=await Y4.readFile(H4(X));return Buffer.from(Q).toString("base64")}}catch{}return X}async fileExists(X){try{return await Y4.access(X),!0}catch{return!1}}async create(X){if(X.from&&await this.fileExists(H4(X.from)))throw Error("Creating with a local path is not currently supported from ollama-js");if(X.stream)return super.create(X);else return super.create(X)}}var F1=new B4;var I8=$.object({originPrompt:$.string()}),f8=$.object({content:$.string(),qualityScore:$.number().min(0).max(1).optional(),reflection:$.string().optional()}),P8=$.object({thought:$.string(),thoughtNumber:$.number().int().positive(),totalThoughts:$.number().int().positive(),nextThoughtNeeded:$.boolean(),isRevision:$.boolean().optional(),revisesThought:$.number().int().positive().optional(),branchFromThought:$.number().int().positive().optional(),branchId:$.string().optional(),needsMoreThoughts:$.boolean().optional()});class M4{async getOllamaCompletion(X){let Q="";try{let W=await F1.generate({model:"deepseek-r1",prompt:X,stream:!0});for await(let J of W){Q=Q+J.response;let G=/<think>([\s\S]*?)<\/think>/i,Y=Q.match(G)?.[1];if(Y)return F1.abort(),"Answer with given reasoning process: "+Y}return"Answer with given reasoning process: "+Q}catch(W){return`Error: ${W}`}}async processRequest(X){try{let{originPrompt:Q}=X;if(!Q)throw new Error("Please provide a prompt");return{content:[{type:"text",text:await this.getOllamaCompletion(Q)}]}}catch(Q){return{content:[{type:"text",text:`Error processing request: ${Q}`}],isError:!0}}}}var T8={name:"deepseek-reasoner",description:"Advanced AI reasoning agent that specializes in deep analytical thinking and complex problem decomposition. Uses the deepseek-r1 model to provide structured analysis and insights that can feed into reflection and sequential thinking processes.",inputSchema:{type:"object",properties:{originPrompt:{type:"string",description:"Problem or question for analysis"}},required:["originPrompt"]}},g8={name:"reflection",description:`
Reflective thinking tool that evaluates reasoning processes and solutions.

Key features:
- Evaluates progress through reflections
- Uses quality scoring (0.0-1.0) to guide approach
- Adjusts strategy based on reward scores:
  * 0.8+ : Continue current approach
  * 0.5-0.7: Consider minor adjustments
  * Below 0.5: Consider alternative approach

Process:
1. Analyze current understanding
2. Evaluate effectiveness using <reflection> tags
3. Assign quality scores with <reward> tags
4. Adjust approach based on scores
5. Continue until satisfactory solution found

Tool provides structure for:
- Critical evaluation of approaches
- Quality-based decision making
- Strategy adjustment
- Solution synthesis
`,inputSchema:{type:"object",properties:{content:{type:"string",description:"Content to reflect upon"},qualityScore:{type:"number",description:"Quality score between 0.0 and 1.0"},reflection:{type:"string",description:`
Reflective thinking tool that evaluates reasoning processes and solutions.

Begin by enclosing all thoughts with sequential thinking for this particular process to identify and explore and analyze the given problem

Break down the solution into clear steps within <step> tags. Start with a 20-step budget, requesting more for complex problems if needed.

Use a specific <count> tag after each step to show the remaining budget. Stop when reaching 0.

Continuously adjust your reasoning based on intermediate results and reflections, adapting your strategy as you progress.

Regularly evaluate progress using <reflection> tags. Be critical and honest about your reasoning process.

Assign a quality score between 0.0 and 1.0 using <reward> tags after each reflection. Use this to guide your approach:

0.8+: Continue current approach
0.5-0.7: Consider minor adjustments
Below 0.5: Seriously consider backtracking and trying a different approach

If unsure or if reward score is low, backtrack and try a different approach, explaining your decision within <thinking> tags.

For mathematical problems, show all work explicitly using LaTeX for formal notation and provide detailed proofs.

Explore multiple solutions individually if possible, comparing approaches in reflections.

Use thoughts as a scratchpad, writing out all calculations and reasoning explicitly.

Synthesize the final answer within <answer> tags, providing a clear, concise summary.

Conclude with a final reflection on the overall solution, discussing effectiveness, challenges, and solutions. Assign a final reward score
`}},required:["content"]}},x8={name:"sequentialthinking",description:`
A detailed tool for dynamic and reflective problem-solving through thoughts. This tool helps analyze problems through a flexible thinking process that can adapt and evolve. Each thought can build on, question, or revise previous insights as understanding deepens. When to use this tool:
- Breaking down complex problems into steps 
- Planning and design with room for revision 
- Analysis that might need course correction 
- Problems where the full scope might not be clear initially 
- Problems that require a multi-step solution 
- Tasks that need to maintain context over multiple steps 
- Situations where irrelevant information needs to be filtered out Key features: 
- You can adjust total_thoughts up or down as you progress 
- You can question or revise previous thoughts 
- You can add more thoughts even after reaching what seemed like the end 
- You can express uncertainty and explore alternative approaches 
- Not every thought needs to build linearly 
- you can branch or backtrack 
- Generates a solution hypothesis 
- Verifies the hypothesis based on the Chain of Thought steps 
- Repeats the process until satisfied 
- Provides a correct answer Parameters explained: 
- thought: Your current thinking step, which can include: * Regular analytical steps * Revisions of previous thoughts * Questions about previous decisions * Realizations about needing more analysis * Changes in approach * Hypothesis generation * Hypothesis verification - next_thought_needed: True if you need more thinking, even if at what seemed like the end - thought_number: Current number in sequence (can go beyond initial total if needed) - total_thoughts: Current estimate of thoughts needed (can be adjusted up/down) - is_revision: A boolean indicating if this thought revises previous thinking - revises_thought: If is_revision is true, which thought number is being reconsidered - branch_from_thought: If branching, which thought number is the branching point - branch_id: Identifier for the current branch (if any) - needs_more_thoughts: If reaching end but realizing more thoughts needed You should: 1. Start with an initial estimate of needed thoughts, but be ready to adjust 2. Feel free to question or revise previous thoughts 3. Don't hesitate to add more thoughts if needed, even at the "end" 4. Express uncertainty when present 5. Mark thoughts that revise previous thinking or branch into new paths 6. Ignore information that is irrelevant to the current step 7. Generate a solution hypothesis when appropriate 8. Verify the hypothesis based on the Chain of Thought steps 9. Repeat the process until satisfied with the solution 10. Provide a single, ideally correct answer as the final output 11. Only set next_thought_needed to false when truly done and a satisfactory answer is reached
`,inputSchema:{type:"object",properties:{thought:{type:"string",description:"Current thinking step"},thoughtNumber:{type:"integer",description:"Current thought number"},totalThoughts:{type:"integer",description:"Total thoughts needed"},nextThoughtNeeded:{type:"boolean",description:"Whether another thought is needed"}},required:["thought","thoughtNumber","totalThoughts","nextThoughtNeeded"]}};class z4{reflectionHistory=[];backtrackThreshold=0.5;extractTags(X){let Q=[],W=[],J=/<reflection>([\s\S]*?)<\/reflection>/g,G;while((G=J.exec(X))!==null)Q.push(G[1].trim());let Y=/<reward>(0\.\d+|1\.0)<\/reward>/g;while((G=Y.exec(X))!==null)W.push(parseFloat(G[1]));return{reflections:Q,rewards:W}}calculateAverageScore(X){if(X.length===0)return 0;return X.reduce((Q,W)=>Q+W,0)/X.length}processReflection(X){try{let Q={...X,timestamp:Date.now()},{reflections:W,rewards:J}=this.extractTags(X.content),G=this.calculateAverageScore(J),Y=G<this.backtrackThreshold,H={extractedContent:{reflections:W,rewardScores:J},analysis:{averageScore:G,needsAdjustment:Y,reflectionCount:W.length,scoreCount:J.length},metadata:{timestamp:Q.timestamp,totalReflections:this.reflectionHistory.length+1}};return{content:[{type:"text",text:JSON.stringify(H,null,2)}]}}catch(Q){return{content:[{type:"text",text:`Error processing reflection: ${Q}`}],isError:!0}}}}class w4{thoughtHistory=[];branches={};validateAndProcessThought(X){let Q=X;if(!Q.thought||typeof Q.thought!=="string")throw new Error("Invalid thought: must be a string");if(!Q.thoughtNumber||typeof Q.thoughtNumber!=="number")throw new Error("Invalid thoughtNumber: must be a number");if(!Q.totalThoughts||typeof Q.totalThoughts!=="number")throw new Error("Invalid totalThoughts: must be a number");if(typeof Q.nextThoughtNeeded!=="boolean")throw new Error("Invalid nextThoughtNeeded: must be a boolean");return{thought:Q.thought,thoughtNumber:Q.thoughtNumber,totalThoughts:Q.totalThoughts,nextThoughtNeeded:Q.nextThoughtNeeded,isRevision:Q.isRevision,revisesThought:Q.revisesThought,branchFromThought:Q.branchFromThought,branchId:Q.branchId,needsMoreThoughts:Q.needsMoreThoughts}}processThought(X){try{let Q=this.validateAndProcessThought(X);if(Q.thoughtNumber>Q.totalThoughts)Q.totalThoughts=Q.thoughtNumber;if(this.thoughtHistory.push(Q),Q.branchFromThought&&Q.branchId){if(!this.branches[Q.branchId])this.branches[Q.branchId]=[];this.branches[Q.branchId].push(Q)}let W={thoughtNumber:Q.thoughtNumber,totalThoughts:Q.totalThoughts,nextThoughtNeeded:Q.nextThoughtNeeded,branches:Object.keys(this.branches),thoughtHistoryLength:this.thoughtHistory.length,branchCount:Object.keys(this.branches).length};return{content:[{type:"text",text:JSON.stringify(W,null,2)}]}}catch(Q){return{content:[{type:"text",text:`Error processing thought: ${Q}`}],isError:!0}}}}var h8=new M4,y8=new z4,Z8=new w4,R1=new B1({name:"advanced-reflection-reasoning-server",version:"1.0.0"},{capabilities:{tools:{}}});R1.setRequestHandler(G1,async()=>({tools:[T8,g8,x8]}));R1.setRequestHandler(J1,async(X)=>{let{name:Q,arguments:W}=X.params;try{switch(Q){case"deepseek-reasoner":let J=I8.parse(W);return await h8.processRequest(J);case"reflection":let G=f8.parse(W);return y8.processReflection(G);case"sequentialthinking":let Y=P8.parse(W);return Z8.processThought(Y);default:return{content:[{type:"text",text:`Unknown tool: ${Q}`}],isError:!0}}}catch(J){return{content:[{type:"text",text:J instanceof $.ZodError?`Invalid arguments: ${J.errors.map((G)=>`${G.path.join(".")}: ${G.message}`).join(", ")}`:`Error processing request: ${J}`}],isError:!0}}});async function l8(){let X=new z1;await R1.connect(X),console.error("Thinking & Reasoning MCP Server running on stdio")}l8().catch((X)=>{console.error("Fatal error in main():",X),process.exit(1)});

//# debugId=AD13BEF8B15231B464756E2164756E21
//# sourceMappingURL=index.js.map
